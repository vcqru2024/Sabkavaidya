"use strict";(self.webpackChunkeav_ui=self.webpackChunkeav_ui||[]).push([["projects_eav-ui_src_app_apps-management_add-app-from-folder_add-app-from-folder_component_ts"],{2204:(j,r,n)=>{n.r(r),n.d(r,{AddAppFromFolderComponent:()=>N});var p=n(1616),c=n(4844),h=n(1484),m=n(5876),g=n(1792),f=n(9432),u=n(1672),C=n(8916),v=n(3584),A=n(604),F=n(6996),y=n(6884),O=n(1743),b=n(924),t=n(4896),x=n(8200),I=n(2328);let G=(()=>{class s{agInit(e){this.name=e.value,this.tooltip=e.tooltipGetter(e.data)}refresh(e){return!0}static#t=this.\u0275fac=function(i){return new(i||s)};static#e=this.\u0275cmp=t.In1({type:s,selectors:[["app-app-name-show"]],decls:5,vars:2,consts:[[1,"name-box"],[1,"info-icon",3,"tippy"]],template:function(i,o){1&i&&(t.I0R(0,"div",0)(1,"span"),t.OEk(2),t.C$Y(),t.I0R(3,"mat-icon",1),t.OEk(4,"info"),t.C$Y()()),2&i&&(t.yG2(2),t.cNF(o.name),t.yG2(1),t.E7m("tippy",o.tooltip))},dependencies:[x.Y,I.qL],styles:[".name-box[_ngcontent-%COMP%]{display:flex;align-items:center}.info-icon[_ngcontent-%COMP%]{margin-left:7px;margin-bottom:3px}"]})}return s})(),$=(()=>{class s{agInit(e){this.params=e}refresh(e){return!0}onChange(e){this.params.onChange(this.params.data,e.currentTarget.checked)}static#t=this.\u0275fac=function(i){return new(i||s)};static#e=this.\u0275cmp=t.In1({type:s,selectors:[["app-checkbox-cell"]],decls:2,vars:2,consts:[[1,"checkbox-box"],["type","checkbox",1,"checkbox-input",3,"disabled","checked","change"]],template:function(i,o){1&i&&(t.I0R(0,"div",0)(1,"input",1),t.qCj("change",function(B){return o.onChange(B)}),t.C$Y()()),2&i&&(t.yG2(1),t.E7m("disabled",o.params.isDisabled)("checked",o.params.value))},styles:[".checkbox-box[_ngcontent-%COMP%]{height:100%;display:flex;align-items:center}.checkbox-input[_ngcontent-%COMP%]{height:15px;width:15px}"]})}return s})();var d=n(600),E=n(4648),R=n(9244),S=n(4072),Y=n(4672),T=n(4616),k=n(5056);function D(s,l){1&s&&(t.I0R(0,"p"),t.OEk(1," Nothing to show. All apps in the 2sxc folder are already installed. "),t.C$Y())}function P(s,l){if(1&s&&(t.I0R(0,"div"),t.wR5(1,"ag-grid-angular",9),t.C$Y()),2&s){const e=t.GaO(),i=t.GaO();t.yG2(1),t.E7m("rowData",e.pendingApps)("gridOptions",i.gridOptions)}}function M(s,l){if(1&s){const e=t.KQA();t.I0R(0,"div",1)(1,"div",2)(2,"div",3),t.OEk(3,"Add App from Folder"),t.C$Y()(),t.I0R(4,"div",4),t.wR5(5,"app-feature-text-info",5),t.I0R(6,"p"),t.OEk(7," Select an app from the apps-folder which has been copied there (or git-cloned) but not installed yet. "),t.C$Y(),t.yuY(8,D,2,0,"p")(9,P,2,2,"div"),t.C$Y(),t.I0R(10,"mat-dialog-actions",6)(11,"button",7),t.qCj("click",function(){t.usT(e);const o=t.GaO();return t.CGJ(o.closeDialog())}),t.OEk(12," Cancel "),t.C$Y(),t.I0R(13,"button",8),t.qCj("click",function(){t.usT(e);const o=t.GaO();return t.CGJ(o.install())}),t.OEk(14," Install "),t.C$Y()()()}if(2&s){const e=t.GaO();t.yG2(5),t.E7m("featureNameId","AppSyncWithSiteFiles"),t.yG2(3),t.C0Y(8,0==(null==l.pendingApps?null:l.pendingApps.length)?8:-1),t.yG2(1),t.C0Y(9,(null==l.pendingApps?null:l.pendingApps.length)>0?9:-1),t.yG2(4),t.E7m("disabled",0===e.pendingApps.length||e.installing)}}let N=(()=>{class s extends y.C{constructor(e,i,o,a){super(),this.dialogRef=e,this.appsListService=i,this.snackBar=o,this.featuresService=a,this.hostClass="dialog-component",this.gridOptions=this.buildGridOptions(),this.pendingApps=[],this.installing=!1,this.refreshApps$=new p.E,this.isAddFromFolderEnabled$=new c.g(!1)}ngOnInit(){this.subscription.add(this.featuresService.isEnabled$(F.y.AppSyncWithSiteFiles).pipe((0,h.a)()).subscribe(this.isAddFromFolderEnabled$)),this.viewModel$=(0,m.E)([this.refreshApps$.pipe((0,g.W)(void 0),(0,f.G)(()=>this.appsListService.getPendingApps().pipe((0,u.a)(()=>(0,C.of)(void 0)))),(0,v.o)())]).pipe((0,A.k)(([e])=>({pendingApps:e})))}ngOnDestroy(){this.refreshApps$.complete(),super.ngOnDestroy()}closeDialog(){this.dialogRef.close()}onChange(e,i){i?this.pendingApps.push(e):this.pendingApps.splice(this.pendingApps.indexOf(e),1)}install(){this.installing=!0,this.snackBar.open("Installing",void 0,{duration:2e3}),this.appsListService.installPendingApps(this.pendingApps).subscribe({error:()=>{this.installing=!1,this.snackBar.open("Failed to install app. Please check console for more information",void 0,{duration:3e3})},next:()=>{this.installing=!1,this.snackBar.open("Installed app",void 0,{duration:2e3}),this.closeDialog()}})}buildGridOptions(){return{...O.A,columnDefs:[{field:"",width:40,cellClass:"no-outline",sortable:!0,cellRenderer:$,cellRendererParams:()=>({isDisabled:!this.isAddFromFolderEnabled$.value,onChange:(o,a)=>this.onChange(o,a)})},{field:"Name",flex:1,cellClass:"no-outline",sortable:!0,sort:"asc",filter:"agTextColumnFilter",cellRenderer:G,cellRendererParams:{tooltipGetter:o=>`Server folder: ${o.ServerFolder}\nFolder: ${o.Folder}\nVersion: ${o.Version}\nDescription: ${o.Description}`}}]}}static#t=this.\u0275fac=function(i){return new(i||s)(t.GI1(d.yI),t.GI1(b.m),t.GI1(E.yS),t.GI1(R.E))};static#e=this.\u0275cmp=t.In1({type:s,selectors:[["app-add-app-from-folder"]],hostVars:1,hostBindings:function(i,o){2&i&&t.SoX("className",o.hostClass)},features:[t.eg9],decls:2,vars:3,consts:[["class","eav-dialog"],[1,"eav-dialog"],[1,"eav-dialog-header"],[1,"eav-dialog-header__title"],[1,"eav-dialog-content"],[3,"featureNameId"],["align","end"],["type","button","mat-raised-button","",3,"click"],["type","button","mat-raised-button","","color","accent",3,"disabled","click"],[1,"ag-theme-material","eav-grid",3,"rowData","gridOptions"]],template:function(i,o){if(1&i&&(t.yuY(0,M,15,4,"div",0),t.wVc(1,"async")),2&i){let a;t.C0Y(0,(a=t.kDX(1,1,o.viewModel$))?0:-1,a)}},dependencies:[d.Yp,S.U5,Y.Gw,T.E,k.a],styles:[".eav-grid[_ngcontent-%COMP%]{height:200px;width:auto}"]})}return s})()}}]);
//# sourceMappingURL=https://sources.2sxc.org/17.04.00/dist/ng-edit/projects_eav-ui_src_app_apps-management_add-app-from-folder_add-app-from-folder_component_ts.697274bc900ed11c.js.map