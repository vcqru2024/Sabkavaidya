"use strict";(self.webpackChunkeav_ui=self.webpackChunkeav_ui||[]).push([["projects_eav-ui_src_app_content-items_content-items_component_ts","projects_eav-ui_src_app_shared_directives_click-stop-propagation_directive_ts","projects_eav-ui_src_app_app-administration_services_app-dialog-config_service_ts-_86580","projects_eav-ui_src_app_app-administration_services_app-dialog-config_service_ts-_86581"],{533:(x,f,a)=>{a.d(f,{m:()=>y});var r=a(7488),c=a(604),m=a(8600),T=a(5200),g=a(6028),_=a(4896),p=a(1332),I=a(3392),h=a(9244);let y=(()=>{class d{constructor(t,v,C,P,$){this.http=t,this.context=v,this.dnnContext=C,this.globalConfigService=P,this.dialogSettings$={},$.loadFromService(this)}getShared$(t){return t??=this.context.appId,this.dialogSettings$[t]||(this.dialogSettings$[t]=this.getDialogSettings(t).pipe((0,r.C)({refCount:!1}))),this.dialogSettings$[t]}getDialogSettings(t){return this.http.get(this.dnnContext.$2sxc.http.apiUrl("admin/dialog/settings"),{params:{appId:t??this.context.appId.toString()}}).pipe((0,c.k)(v=>(v.Context.Language.List=v.Context.Language.List.filter(C=>C.IsEnabled),v)),(0,m.y)(v=>{this.globalConfigService.allowDebug(v.Context.Enable.DebugMode)}))}static#t=this.\u0275fac=function(v){return new(v||d)(_.CoB(p.KK),_.CoB(g.e),_.CoB(I.es),_.CoB(T.Sq),_.CoB(h.E))};static#e=this.\u0275prov=_.wxM({token:d,factory:d.\u0275fac})}return d})()},6964:(x,f,a)=>{a.d(f,{M:()=>_});var r=a(6028),c=a(9644),m=a(4896),T=a(1332),g=a(3392);let _=(()=>{class p{constructor(h,u,y){this.http=h,this.context=u,this.dnnContext=y}getContentInfo(h){return this.http.get(this.dnnContext.$2sxc.http.apiUrl(c._+"Get"),{params:{appid:this.context.appId.toString(),zoneId:this.context.zoneId.toString(),scope:h}})}exportParts(h,u,y){const d=this.dnnContext.$2sxc.http.apiUrl(c._+"Export")+"?appId="+this.context.appId.toString()+"&zoneId="+this.context.zoneId.toString()+"&contentTypeIdsString="+h.join(";")+"&entityIdsString="+u.join(";")+"&templateIdsString="+y.join(";");window.open(d,"_blank","")}static#t=this.\u0275fac=function(u){return new(u||p)(m.CoB(T.KK),m.CoB(r.e),m.CoB(g.es))};static#e=this.\u0275prov=m.wxM({token:p,factory:p.\u0275fac})}return p})()},6503:(x,f,a)=>{a.d(f,{S:()=>_});var r=a(5343),c=a(6028),m=a(4896),T=a(1332),g=a(3392);let _=(()=>{class p{constructor(h,u,y){this.http=h,this.context=u,this.dnnContext=y}getAppInfo(){return this.http.get(this.dnnContext.$2sxc.http.apiUrl(r.i+"Statistics"),{params:{appid:this.context.appId.toString(),zoneId:this.context.zoneId.toString()}})}exportApp(h,u){const y=this.dnnContext.$2sxc.http.apiUrl(r.i+"Export")+"?appId="+this.context.appId+"&zoneId="+this.context.zoneId+"&includeContentGroups="+h+"&resetAppGuid="+u;window.open(y,"_blank","")}exportForVersionControl({includeContentGroups:h,resetAppGuid:u,withFiles:y}){return this.http.get(this.dnnContext.$2sxc.http.apiUrl(r.i+"SaveData"),{params:{appid:this.context.appId.toString(),zoneId:this.context.zoneId.toString(),includeContentGroups:h.toString(),resetAppGuid:u.toString(),withPortalFiles:y.toString()}})}static#t=this.\u0275fac=function(u){return new(u||p)(m.CoB(T.KK),m.CoB(c.e),m.CoB(g.es))};static#e=this.\u0275prov=m.wxM({token:p,factory:p.\u0275fac})}return p})()},9644:(x,f,a)=>{a.d(f,{M:()=>p,_:()=>_});var r=a(5343),c=a(6028),m=a(4896),T=a(1332),g=a(3392);const _="admin/appParts/";let p=(()=>{class I{constructor(u,y,d){this.http=u,this.context=y,this.dnnContext=d}importAppParts(u){const y=new FormData;return y.append("File",u),this.http.post(this.dnnContext.$2sxc.http.apiUrl(_+"Import"),y,{params:{appId:this.context.appId.toString(),zoneId:this.context.zoneId.toString()}})}resetApp(u){return this.http.post(this.dnnContext.$2sxc.http.apiUrl(r.i+"Reset"),{},{params:{appId:this.context.appId.toString(),zoneId:this.context.zoneId.toString(),withPortalFiles:u.toString()}})}static#t=this.\u0275fac=function(y){return new(y||I)(m.CoB(T.KK),m.CoB(c.e),m.CoB(g.es))};static#e=this.\u0275prov=m.wxM({token:I,factory:I.\u0275fac})}return I})()},8112:(x,f,a)=>{a.d(f,{K0:()=>_.K0,Xi:()=>c.X,cV:()=>_.cV,fn:()=>_.fn,kN:()=>_.kN,kX:()=>_.kX,mK:()=>r.m,ot:()=>_.ot,sj:()=>p.s});var r=a(533),c=a(692),_=(a(6964),a(6503),a(9644),a(900)),p=a(7184)},900:(x,f,a)=>{a.d(f,{K0:()=>P,cV:()=>t,fn:()=>v,kN:()=>C,kX:()=>$,ot:()=>D});var r=a(9616),c=a(9432),m=a(604),T=a(4172),g=a(616),_=a(6028),p=a(4896),I=a(1332),h=a(3392);const D="admin/query/Run",t="admin/query/DebugStream",v="admin/query/Save",C="admin/query/Get",P="admin/query/DataSources";let $=(()=>{class G{constructor(b,O,L){this.http=b,this.context=O,this.dnnContext=L}getAll(b){return this.http.get(this.dnnContext.$2sxc.http.apiUrl(T.U1),{params:{appId:this.context.appId.toString(),contentType:b}})}importQuery(b){return(0,r.Q)((0,g.S)(b)).pipe((0,c.G)(O=>this.http.post(this.dnnContext.$2sxc.http.apiUrl("admin/query/import"),{AppId:this.context.appId.toString(),ContentBase64:O})),(0,m.k)(O=>({Success:O,Messages:[]})))}clonePipeline(b){return this.http.get(this.dnnContext.$2sxc.http.apiUrl("admin/query/Clone"),{params:{Id:b.toString(),appId:this.context.appId.toString()}})}delete(b){return this.http.delete(this.dnnContext.$2sxc.http.apiUrl("admin/query/Delete"),{params:{appId:this.context.appId.toString(),Id:b.toString()}})}static#t=this.\u0275fac=function(O){return new(O||G)(p.CoB(I.KK),p.CoB(_.e),p.CoB(h.es))};static#e=this.\u0275prov=p.wxM({token:G,factory:G.\u0275fac})}return G})()},7184:(x,f,a)=>{a.d(f,{s:()=>y});var r=a(6028),c=a(4896),m=a(1332),T=a(3392);const g="admin/view/",_=g+"all",p=g+"delete",I=g+"import",h=g+"polymorphism",u=g+"usage";let y=(()=>{class d{constructor(t,v,C){this.http=t,this.context=v,this.dnnContext=C}getAll(){return this.http.get(this.dnnContext.$2sxc.http.apiUrl(_),{params:{appId:this.context.appId.toString()}})}delete(t){return this.http.get(this.dnnContext.$2sxc.http.apiUrl(p),{params:{appId:this.context.appId.toString(),Id:t.toString()}})}import(t){const v=new FormData;return v.append("File",t),this.http.post(this.dnnContext.$2sxc.http.apiUrl(I),v,{params:{appId:this.context.appId.toString(),zoneId:this.context.zoneId.toString()}})}export(t){const v=this.dnnContext.$2sxc.http.apiUrl(g+"json")+"?appId="+this.context.appId+"&viewId="+t;window.open(v,"_blank","")}getPolymorphism(){return this.http.get(this.dnnContext.$2sxc.http.apiUrl(h),{params:{appId:this.context.appId.toString()}})}getUsage(t){return this.http.get(this.dnnContext.$2sxc.http.apiUrl(u),{params:{appId:this.context.appId.toString(),guid:t}})}static#t=this.\u0275fac=function(v){return new(v||d)(c.CoB(m.KK),c.CoB(r.e),c.CoB(T.es))};static#e=this.\u0275prov=c.wxM({token:d,factory:d.\u0275fac})}return d})()},3935:(x,f,a)=>{a.r(f),a.d(f,{ContentItemsComponent:()=>_e});var r=a(1616),c=a(4844),m=a(5876),T=a(604),g=a(6560),_=a(7496),p=a(692),I=a(1292),h=a(9427),u=a(5200),y=a(7028),d=a(2816),D=a(5960),t=a(4896),v=a(244),C=a(1904),P=a(2536);const $=["valueInput"];let G=(()=>{class o{constructor(){this.filter="",this.idFilterString="",this.idFilter=[]}agInit(e){this.filterParams=e}isFilterActive(){return""!==this.filter||this.idFilter.length>0}doesFilterPass(e){if(""!==this.filter){const i=this.filterParams.valueGetter({api:this.filterParams.api,colDef:this.filterParams.colDef,column:this.filterParams.column,columnApi:this.filterParams.columnApi,context:this.filterParams.context,data:e.node.data,getValue:s=>e.node.data[s],node:e.node});if(null==i||!i.some(s=>!!s&&s.includes(this.filter)))return!1}if(this.idFilter.length>0){const n=e.data[this.filterParams.colDef.headerName];if(null==n||!this.idFilter.some(i=>n.some(s=>s.Id===i)))return!1}return!0}getModel(){return this.isFilterActive()?{filterType:"entity",filter:this.filter,idFilter:this.idFilter}:void 0}setModel(e){this.filter=e?.filter??"",this.idFilter=e?.idFilter??[],this.idFilterString=e?.idFilter?.join(",")??""}afterGuiAttached(e){this.valueInputRef.nativeElement.focus()}updateIdFilter(){this.idFilter=this.idFilterString.split(",").map(e=>parseInt(e,10)).filter(e=>!isNaN(e))}filterChanged(){this.filterParams.filterChangedCallback()}static#t=this.\u0275fac=function(n){return new(n||o)};static#e=this.\u0275cmp=t.In1({type:o,selectors:[["app-entity-filter"]],viewQuery:function(n,i){if(1&n&&t.CC$($,5),2&n){let s;t.wto(s=t.Gqi())&&(i.valueInputRef=s.first)}},decls:9,vars:2,consts:[["color","accent",1,"eav-form-field"],["matInput","","type","text",3,"ngModel","ngModelChange"],["valueInput",""]],template:function(n,i){1&n&&(t.I0R(0,"mat-form-field",0)(1,"mat-label"),t.OEk(2,"Value"),t.C$Y(),t.I0R(3,"input",1,2),t.qCj("ngModelChange",function(E){return i.filter=E})("ngModelChange",function(){return i.filterChanged()}),t.C$Y()(),t.I0R(5,"mat-form-field",0)(6,"mat-label"),t.OEk(7,"IDs (comma separated)"),t.C$Y(),t.I0R(8,"input",1),t.qCj("ngModelChange",function(E){return i.idFilterString=E})("ngModelChange",function(){return i.updateIdFilter(),i.filterChanged()}),t.C$Y()()),2&n&&(t.yG2(3),t.E7m("ngModel",i.filter),t.yG2(5),t.E7m("ngModel",i.idFilterString))},dependencies:[v.Up,v.w5,C.ot,C.ue,C._G,P.yi],styles:["[_nghost-%COMP%]{display:block;padding:16px 12px 2px}.mat-mdc-form-field[_ngcontent-%COMP%]{display:block;width:175px}"]})}return o})();var q=a(5760),b=a(1743),O=a(9224),L=a(664),tt=a(624),j=a(5396),k=a(8200),W=a(2328),V=a(6176),w=a(7848);function et(o,l){if(1&o){const e=t.KQA();t.I0R(0,"button",7),t.qCj("click",function(){t.usT(e);const i=t.GaO();return t.CGJ(i.deleteItem())}),t.I0R(1,"mat-icon"),t.OEk(2,"delete"),t.C$Y(),t.I0R(3,"span"),t.OEk(4,"Delete"),t.C$Y()()}if(2&o){const e=t.GaO();t.E7m("disabled",e.item._EditInfo.DisableDelete)}}let nt=(()=>{class o{agInit(e){this.params=e,this.item=e.data}refresh(e){return!0}clone(){this.params.onClone(this.item)}export(){this.params.onExport(this.item)}deleteItem(){this.params.onDelete(this.item)}static#t=this.\u0275fac=function(n){return new(n||o)};static#e=this.\u0275cmp=t.In1({type:o,selectors:[["app-content-items-actions"]],decls:13,vars:1,consts:[[1,"actions-component"],["matRipple","","tippy","Copy",1,"eav-grid-action-button","highlight",3,"click"],["matRipple","","tippy","Export",1,"eav-grid-action-button","highlight",3,"click"],["matRipple","","tippy","More",1,"eav-grid-action-button","highlight",3,"matMenuTriggerFor"],[1,"grid-more-menu"],["menu","matMenu"],["matMenuContent",""],["mat-menu-item","",3,"disabled","click"]],template:function(n,i){if(1&n&&(t.I0R(0,"div",0)(1,"div",1),t.qCj("click",function(){return i.clone()}),t.I0R(2,"mat-icon"),t.OEk(3,"file_copy"),t.C$Y()(),t.I0R(4,"div",2),t.qCj("click",function(){return i.export()}),t.I0R(5,"mat-icon"),t.OEk(6,"cloud_download"),t.C$Y()(),t.I0R(7,"div",3)(8,"mat-icon"),t.OEk(9,"more_horiz"),t.C$Y()()(),t.I0R(10,"mat-menu",4,5),t.yuY(12,et,5,1,"ng-template",6),t.C$Y()),2&n){const s=t.Gew(11);t.yG2(7),t.E7m("matMenuTriggerFor",s)}},dependencies:[k.Y,W.qL,V.UZ,w.aM,w.OQ,w.M5,w.yG]})}return o})();function ot(o,l){if(1&o&&(t.I0R(0,"span",2),t.OEk(1),t.C$Y()),2&o){const e=t.GaO();t.yG2(1),t.cNF(e.entities)}}let at=(()=>{class o{agInit(e){Array.isArray(e.value)&&(this.encodedValue=this.htmlEncode(e.value.join(", ")),e.colDef.allowMultiValue&&(this.entities=e.value.length))}refresh(e){return!0}htmlEncode(e){return e.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}static#t=this.\u0275fac=function(n){return new(n||o)};static#e=this.\u0275cmp=t.In1({type:o,selectors:[["app-content-items-entity"]],decls:3,vars:3,consts:[[3,"tippy"],["class","more-entities"],[1,"more-entities"]],template:function(n,i){1&n&&(t.I0R(0,"div",0),t.yuY(1,ot,2,1,"span",1),t.OEk(2),t.C$Y()),2&n&&(t.E7m("tippy",i.encodedValue),t.yG2(1),t.C0Y(1,i.entities?1:-1),t.yG2(1),t.oRS(" ",i.encodedValue,"\n"))},dependencies:[k.Y],styles:[".more-entities[_ngcontent-%COMP%]{padding:0 8px;border-radius:10px;border:1px solid rgba(29,39,61,.44);-webkit-user-select:none;user-select:none}"]})}return o})();var S=a(5056),it=a(32);const st=o=>({"hide-until-row-hover":o});function rt(o,l){if(1&o){const e=t.KQA();t.I0R(0,"div",4),t.qCj("click",function(){t.usT(e);const i=t.GaO();return t.CGJ(i.openMetadata())}),t.I0R(1,"mat-icon",5),t.OEk(2),t.C$Y()()}if(2&o){const e=t.GaO();t.E7m("ngClass",t.S45(5,st,!e.metadataCount&&!e.value.metadata))("tippy",e.metadataTooltip),t.yG2(1),t.E7m("matBadge",e.metadataCount)("matBadgeHidden",!e.metadataCount),t.yG2(1),t.oRS("",e.value.metadata?"loyalty":"local_offer"," ")}}function lt(o,l){if(1&o&&(t.I0R(0,"div",6)(1,"mat-icon",7),t.OEk(2),t.C$Y()()),2&o){const e=t.GaO();t.yG2(1),t.E7m("matBadge",e.metadataCount)("matBadgeHidden",!e.metadataCount),t.yG2(1),t.oRS("",e.value.metadata?"loyalty":"local_offer"," ")}}let ct=(()=>{class o{agInit(e){this.value=e.value,this.params=e,this.item=e.data,this.disableMetadata=this.item._EditInfo.DisableMetadata,this.metadataCount=this.item.Metadata?.length??0;const n=this.item.For;this.metadataTooltip=n?`This item is metadata for:\nTarget: ${n.Target}\nTargetType: ${n.TargetType}`+(n.KeyNumber?`\nNumber: ${n.KeyNumber}`:"")+(n.KeyString?`\nString: ${n.KeyString}`:"")+(n.KeyGuid?`\nGuid: ${n.KeyGuid}`:"")+(n.Title?`\nTitle: ${n.Title}`:""):"This item is not metadata.",this.metadataTooltip+=`\n\nThis item has ${this.metadataCount>0?this.metadataCount:"no"} other metadata ${1===this.metadataCount?"item":"items"} attached to it.`}refresh(e){return!0}openMetadata(){this.params.onOpenMetadata(this.item)}static#t=this.\u0275fac=function(n){return new(n||o)};static#e=this.\u0275cmp=t.In1({type:o,selectors:[["app-content-items-status"]],decls:6,vars:4,consts:[[1,"actions-component"],[1,"eav-grid-action-button","icon",3,"tippy"],["class","eav-grid-action-button highlight","matRipple","",3,"ngClass","tippy"],["class","eav-grid-action-button disabled"],["matRipple","",1,"eav-grid-action-button","highlight",3,"ngClass","tippy","click"],["matBadgeColor","accent","matBadgeSize","small","matBadgePosition","below after","aria-hidden","false",3,"matBadge","matBadgeHidden"],[1,"eav-grid-action-button","disabled"],["matBadgeColor","accent","matBadgeSize","small","matBadgeDisabled","true","matBadgePosition","below after","aria-hidden","false",3,"matBadge","matBadgeHidden"]],template:function(n,i){1&n&&(t.I0R(0,"div",0)(1,"div",1)(2,"mat-icon"),t.OEk(3),t.C$Y()(),t.yuY(4,rt,3,7,"div",2)(5,lt,3,3,"div",3),t.C$Y()),2&n&&(t.yG2(1),t.E7m("tippy",i.value.published?"Published":"Not published"),t.yG2(2),t.cNF(i.value.published?"visibility":"visibility_off"),t.yG2(1),t.C0Y(4,i.disableMetadata?-1:4),t.yG2(1),t.C0Y(5,i.disableMetadata&&(i.metadataCount||i.value.metadata)?5:-1))},dependencies:[S.QF,k.Y,W.qL,V.UZ,it.S],styles:[".hide-until-row-hover[_ngcontent-%COMP%]{visibility:hidden}  .ag-row-hover .hide-until-row-hover{visibility:visible}"]})}return o})();var A=a(8928),H=a(1792),K=a(1484),pt=a(728),mt=a(8112),ut=a(6884),z=a(420),_t=a(6028),J=a(6036),ht=a(2260);function Ct(o){return l=>{if(!l.value)return null;const e=o.controls.keyType.value,n=l.value.toString();switch(e){case O._K.keyTypes.number:return/^[0-9]+$/.test(n)?null:{patternWholeNumber:!0};case O._K.keyTypes.guid:const s=["{","}"].some(R=>n.includes(R)),E=n.substring(s?1:0,s?n.length-1:n.length);return(0,ht.y)().test(E)?null:{patternGuid:!0};default:return null}}}var Y=a(600),gt=a(9084),ft=a(504),B=a(4672),yt=a(7872),vt=a(3424);function Tt(o,l){if(1&o&&(t.I0R(0,"mat-option",20),t.OEk(1),t.C$Y()),2&o){const e=l.$implicit;t.E7m("value",e.targetType),t.yG2(1),t.oRS(" ",e.label," ")}}function It(o,l){if(1&o&&(t.I0R(0,"mat-option",20),t.OEk(1),t.C$Y()),2&o){const e=t.GaO(2);t.E7m("value",e.formValues.targetType),t.yG2(1),t.oRS(" ",e.formValues.targetType," ")}}function Et(o,l){if(1&o&&(t.I0R(0,"mat-select",8),t.c53(1,Tt,2,2,"mat-option",20,t.oxv),t.yuY(3,It,2,2,"mat-option",20),t.C$Y()),2&o){const e=t.GaO(),n=t.GaO();t.yG2(1),t.oho(n.targetTypeOptions),t.yG2(2),t.C0Y(3,e.unknownTargetType?3:-1)}}function Mt(o,l){1&o&&t.wR5(0,"input",9)}function Ot(o,l){1&o&&(t.I0R(0,"app-field-hint",10),t.OEk(1," Warning: you entered an unknown target type. This may work or may not. Please be sure you know what you're doing "),t.C$Y()),2&o&&t.E7m("isError",!1)}function Dt(o,l){if(1&o&&(t.I0R(0,"app-field-hint",10),t.OEk(1),t.C$Y()),2&o){const e=t.GaO();t.E7m("isError",!1),t.yG2(1),t.cNF(e.targetTypeHint)}}function xt(o,l){1&o&&(t.I0R(0,"app-field-hint",10),t.OEk(1," This field is required "),t.C$Y()),2&o&&t.E7m("isError",!0)}function Rt(o,l){1&o&&(t.I0R(0,"app-field-hint",10),t.OEk(1," Must be a whole number "),t.C$Y()),2&o&&t.E7m("isError",!0)}function Pt(o,l){if(1&o&&(t.I0R(0,"mat-option",20),t.OEk(1),t.C$Y()),2&o){const e=l.$implicit;t.E7m("value",e),t.yG2(1),t.oRS(" ",e," ")}}function bt(o,l){1&o&&(t.I0R(0,"app-field-hint",10),t.OEk(1," This field is required "),t.C$Y()),2&o&&t.E7m("isError",!0)}function Gt(o,l){if(1&o&&(t.I0R(0,"mat-option",20),t.OEk(1),t.C$Y()),2&o){const e=l.$implicit;t.E7m("value",e.StaticName),t.yG2(1),t.oRS(" ",e.Label," ")}}function $t(o,l){if(1&o&&(t.I0R(0,"mat-form-field",7)(1,"mat-label"),t.OEk(2,"Content Type"),t.C$Y(),t.I0R(3,"mat-select",21),t.c53(4,Gt,2,2,"mat-option",20,t.oxv),t.C$Y()()),2&o){const e=t.GaO();t.yG2(3),t.E7m("placeholder",e.contentTypes.length?"":"No items found"),t.yG2(1),t.oho(e.contentTypes)}}function kt(o,l){if(1&o&&(t.I0R(0,"mat-option",20),t.OEk(1),t.C$Y()),2&o){const e=l.$implicit;t.E7m("value",e.value),t.yG2(1),t.oRS(" ",e.name," ")}}function St(o,l){if(1&o&&(t.I0R(0,"mat-form-field",7)(1,"mat-label"),t.OEk(2,"Scope"),t.C$Y(),t.I0R(3,"mat-select",22),t.c53(4,kt,2,2,"mat-option",20,t.oxv),t.I0R(6,"mat-option",20),t.OEk(7,"Other..."),t.C$Y()()()),2&o){const e=t.GaO(),n=t.GaO();t.yG2(3),t.E7m("placeholder",e.scopeOptions.length?"":"No items found"),t.yG2(1),t.oho(e.scopeOptions),t.yG2(2),t.E7m("value",n.dropdownInsertValue)}}function At(o,l){if(1&o&&(t.I0R(0,"mat-option",20),t.OEk(1),t.C$Y()),2&o){const e=l.$implicit;t.E7m("value",e.Guid),t.yG2(1),t.CAO(" ",e.Title," (",e.Id,") ")}}function Kt(o,l){if(1&o&&(t.I0R(0,"mat-select",23),t.c53(1,At,2,3,"mat-option",20,t.oxv),t.C$Y()),2&o){const e=t.GaO(3);t.E7m("placeholder",e.contentItems.length?"":"No items found"),t.yG2(1),t.oho(e.contentItems)}}function Yt(o,l){1&o&&t.wR5(0,"input",24)}function Bt(o,l){if(1&o&&t.yuY(0,Kt,3,1,"mat-select",23)(1,Yt,1,0,"input",24),2&o){const e=t.GaO(2);t.C0Y(0,e.guidedKey?0:-1),t.yG2(1),t.C0Y(1,e.guidedKey?-1:1)}}function Ft(o,l){if(1&o&&(t.I0R(0,"mat-option",20),t.OEk(1),t.C$Y()),2&o){const e=l.$implicit;t.E7m("value",e.StaticName),t.yG2(1),t.oRS(" ",e.Label," ")}}function Ut(o,l){if(1&o&&(t.I0R(0,"mat-select",23),t.c53(1,Ft,2,2,"mat-option",20,t.oxv),t.C$Y()),2&o){const e=t.GaO(3);t.E7m("placeholder",e.contentTypes.length?"":"No items found"),t.yG2(1),t.oho(e.contentTypes)}}function Lt(o,l){1&o&&t.wR5(0,"input",24)}function Wt(o,l){if(1&o&&t.yuY(0,Ut,3,1,"mat-select",23)(1,Lt,1,0,"input",24),2&o){const e=t.GaO(2);t.C0Y(0,e.guidedKey?0:-1),t.yG2(1),t.C0Y(1,e.guidedKey?-1:1)}}function wt(o,l){1&o&&t.C_f(0)}function Nt(o,l){if(1&o&&t.yuY(0,wt,1,0,"ng-container",25),2&o){t.GaO(2);const e=t.Gew(39);t.E7m("ngTemplateOutlet",e)}}function jt(o,l){if(1&o&&t.yuY(0,Bt,2,2)(1,Wt,2,2)(2,Nt,1,1),2&o){const e=t.GaO(),n=t.GaO();let i;t.C0Y(0,(i=e.formValues.targetType)===n.eavConstants.metadata.entity.targetType?0:i===n.eavConstants.metadata.contentType.targetType?1:2)}}function Vt(o,l){1&o&&t.wR5(0,"input",24)}function Ht(o,l){1&o&&t.wR5(0,"input",26)}function Qt(o,l){if(1&o&&t.yuY(0,Vt,1,0,"input",24)(1,Ht,1,0,"input",26),2&o){const e=t.GaO(),n=t.GaO();t.C0Y(0,e.formValues.keyType!==n.eavConstants.keyTypes.number?0:-1),t.yG2(1),t.C0Y(1,e.formValues.keyType===n.eavConstants.keyTypes.number?1:-1)}}function zt(o,l){1&o&&t.wR5(0,"input",24)}function Jt(o,l){1&o&&t.wR5(0,"input",26)}function Xt(o,l){if(1&o&&t.yuY(0,zt,1,0,"input",24)(1,Jt,1,0,"input",26),2&o){const e=t.GaO(),n=t.GaO();t.C0Y(0,e.formValues.keyType!==n.eavConstants.keyTypes.number?0:-1),t.yG2(1),t.C0Y(1,e.formValues.keyType===n.eavConstants.keyTypes.number?1:-1)}}const X=o=>({active:o});function Zt(o,l){if(1&o){const e=t.KQA();t.I0R(0,"div",27)(1,"button",28),t.qCj("click",function(){t.usT(e);const i=t.GaO(2);return t.CGJ(i.toggleGuidedKey(!0))}),t.I0R(2,"mat-icon",29),t.OEk(3,"search"),t.C$Y()(),t.I0R(4,"button",30),t.qCj("click",function(){t.usT(e);const i=t.GaO(2);return t.CGJ(i.toggleGuidedKey(!1))}),t.I0R(5,"mat-icon",29),t.OEk(6,"text_fields"),t.C$Y()()()}if(2&o){const e=t.GaO();t.yG2(1),t.E7m("ngClass",t.S45(2,X,e.guidedKey)),t.yG2(3),t.E7m("ngClass",t.S45(4,X,!e.guidedKey))}}function qt(o,l){1&o&&(t.I0R(0,"app-field-hint",10),t.OEk(1," This field is required "),t.C$Y()),2&o&&t.E7m("isError",!0)}function te(o,l){1&o&&(t.I0R(0,"app-field-hint",10),t.OEk(1," Must be a whole number "),t.C$Y()),2&o&&t.E7m("isError",!0)}function ee(o,l){1&o&&(t.I0R(0,"app-field-hint",10),t.OEk(1," Must be a valid GUID "),t.C$Y()),2&o&&t.E7m("isError",!0)}function ne(o,l){if(1&o){const e=t.KQA();t.I0R(0,"div",1)(1,"div",2)(2,"div",3),t.OEk(3,"Create Metadata"),t.C$Y()(),t.I0R(4,"div",4)(5,"p"),t.OEk(6," This is a special operation to add an item which is metadata for another item, see "),t.I0R(7,"a",5),t.OEk(8,"docs"),t.C$Y(),t.OEk(9,". "),t.C$Y(),t.I0R(10,"form",6)(11,"mat-form-field",7)(12,"mat-label"),t.OEk(13,"Target"),t.C$Y(),t.yuY(14,Et,4,1,"mat-select",8)(15,Mt,1,0,"input",9),t.C$Y(),t.yuY(16,Ot,2,1,"app-field-hint",10)(17,Dt,2,2,"app-field-hint",10)(18,xt,2,1,"app-field-hint",10)(19,Rt,2,1,"app-field-hint",10),t.I0R(20,"mat-form-field",7)(21,"mat-label"),t.OEk(22,"Key type"),t.C$Y(),t.I0R(23,"mat-select",11),t.c53(24,Pt,2,2,"mat-option",20,t.oxv),t.C$Y()(),t.yuY(26,bt,2,1,"app-field-hint",10)(27,$t,6,1,"mat-form-field",12)(28,St,8,2,"mat-form-field",12),t.I0R(29,"app-field-hint"),t.OEk(30," The scope should almost never be changed - "),t.I0R(31,"a",13),t.OEk(32,"see help"),t.C$Y()(),t.I0R(33,"mat-form-field",7)(34,"mat-label"),t.OEk(35,"Key"),t.C$Y(),t.yuY(36,jt,3,1)(37,Qt,2,2)(38,Xt,2,2,"ng-template",null,14,t.gJz)(40,Zt,7,6,"div",15),t.C$Y(),t.yuY(41,qt,2,1,"app-field-hint",10)(42,te,2,1,"app-field-hint",10)(43,ee,2,1,"app-field-hint",10),t.C$Y()(),t.I0R(44,"mat-dialog-actions",16)(45,"mat-slide-toggle",17),t.qCj("change",function(i){t.usT(e);const s=t.GaO();return t.CGJ(s.toggleGuidedMode(i))}),t.OEk(46),t.C$Y(),t.I0R(47,"div")(48,"button",18),t.qCj("click",function(){t.usT(e);const i=t.GaO();return t.CGJ(i.closeDialog())}),t.OEk(49,"Cancel"),t.C$Y(),t.I0R(50,"button",19),t.qCj("click",function(){t.usT(e);const i=t.GaO();return t.CGJ(i.confirm())}),t.OEk(51," Confirm "),t.C$Y()()()()}if(2&o){const e=t.GaO();t.yG2(10),t.E7m("formGroup",e.form),t.yG2(4),t.C0Y(14,l.guidedMode?14:-1),t.yG2(1),t.C0Y(15,l.guidedMode?-1:15),t.yG2(1),t.C0Y(16,e.form.controls.targetType.touched&&!e.form.controls.targetType.invalid&&l.unknownTargetType?16:-1),t.yG2(1),t.C0Y(17,l.targetTypeHint?17:-1),t.yG2(1),t.C0Y(18,e.form.controls.targetType.touched&&null!=e.form.controls.targetType.errors&&e.form.controls.targetType.errors.required?18:-1),t.yG2(1),t.C0Y(19,e.form.controls.targetType.touched&&null!=e.form.controls.targetType.errors&&e.form.controls.targetType.errors.pattern?19:-1),t.yG2(5),t.oho(l.keyTypeOptions),t.yG2(2),t.C0Y(26,e.form.controls.keyType.touched&&null!=e.form.controls.keyType.errors&&e.form.controls.keyType.errors.required?26:-1),t.yG2(1),t.C0Y(27,l.guidedMode&&l.formValues.targetType===e.eavConstants.metadata.entity.targetType?27:-1),t.yG2(1),t.C0Y(28,!l.guidedMode||l.formValues.targetType!==e.eavConstants.metadata.entity.targetType&&l.formValues.targetType!==e.eavConstants.metadata.contentType.targetType?-1:28),t.yG2(8),t.C0Y(36,l.guidedMode?36:37),t.yG2(4),t.C0Y(40,l.guidedMode&&l.guidedKeyExists?40:-1),t.yG2(1),t.C0Y(41,e.form.controls.key.touched&&null!=e.form.controls.key.errors&&e.form.controls.key.errors.required?41:-1),t.yG2(1),t.C0Y(42,e.form.controls.key.touched&&null!=e.form.controls.key.errors&&e.form.controls.key.errors.patternWholeNumber?42:-1),t.yG2(1),t.C0Y(43,e.form.controls.key.touched&&null!=e.form.controls.key.errors&&e.form.controls.key.errors.patternGuid?43:-1),t.yG2(2),t.E7m("tippy",l.guidedMode?"Guided mode helps you select options that work":"Manual mode is for advanced uses and allows you to insert any values")("checked",l.guidedMode),t.yG2(1),t.oRS(" ",l.guidedMode?"Guided":"Manual"," "),t.yG2(4),t.E7m("disabled",!e.form.valid)}}let oe=(()=>{class o extends ut.C{constructor(e,n,i,s){super(),this.dialogRef=e,this.context=n,this.contentItemsService=i,this.contentTypesService=s,this.hostClass="dialog-component",this.eavConstants=O._K,this.dropdownInsertValue=z.M}ngOnInit(){this.targetTypeOptions=Object.values(O._K.metadata).map(n=>({...n})),this.keyTypeOptions=Object.values(O._K.keyTypes),this.keyTypeOptions$=new c.g([]),this.scopeOptions$=new c.g([]),this.guidedMode$=new c.g(!0),this.contentItems$=new c.g([]),this.contentTypes$=new c.g([]),this.guidedKey$=new c.g(!0),this.fetchScopes(),this.form=new C.k1({}),this.form.addControl("targetType",new C.yM(O._K.metadata.entity.targetType,[C.AQ.required,C.AQ.pattern(/^[0-9]+$/)])),this.form.addControl("keyType",new C.yM(O._K.metadata.entity.keyType,[C.AQ.required])),this.form.addControl("contentTypeForContentItems",new C.yM(null)),this.form.addControl("scopeForContentTypes",new C.yM(O._K.scopes.default.value)),this.form.addControl("key",new C.yM(null,[C.AQ.required,Ct(this.form)])),this.subscription.add(this.form.controls.scopeForContentTypes.valueChanges.pipe((0,H.W)(this.form.controls.scopeForContentTypes.value),(0,K.a)()).subscribe(n=>{null!=this.form.controls.contentTypeForContentItems.value&&this.form.controls.contentTypeForContentItems.patchValue(null),n===z.M?(n=prompt("This is an advanced feature to show content-types of another scope. Don't use this if you don't know what you're doing, as content-types of other scopes are usually hidden for a good reason.")||O._K.scopes.default.value,this.scopeOptions$.value.some(i=>i.value===n)||this.scopeOptions$.next([{name:n,value:n},...this.scopeOptions$.value]),this.form.controls.scopeForContentTypes.patchValue(n)):this.fetchContentTypes(n)})),this.subscription.add((0,pt.U)(this.form.controls.targetType.valueChanges.pipe((0,K.a)()),this.form.controls.keyType.valueChanges.pipe((0,K.a)())).subscribe(()=>{this.guidedKey$.next(!0),null!=this.form.getRawValue().key&&this.form.patchValue({key:null})})),this.subscription.add(this.form.controls.contentTypeForContentItems.valueChanges.pipe((0,H.W)(this.form.controls.contentTypeForContentItems.value),(0,K.a)()).subscribe(n=>{const i=this.form.getRawValue();i.targetType===O._K.metadata.entity.targetType&&null!=i.key&&this.form.patchValue({key:null}),this.contentItemsService.getAll(n).subscribe(s=>{this.contentItems$.next(s)})}));const e=this.form.valueChanges.pipe((0,H.W)(this.form.getRawValue()),(0,T.k)(()=>this.form.getRawValue()),(0,K.a)(A.Co.objectsEqual));this.subscription.add((0,m.E)([e,this.guidedMode$]).subscribe(([n,i])=>{const s=this.targetTypeOptions.find(N=>N.targetType===n.targetType),E=i&&s?[s.keyType]:[...this.keyTypeOptions];A.Co.arraysEqual(E,this.keyTypeOptions$.value)||this.keyTypeOptions$.next(E);const M={};this.keyTypeOptions$.value.includes(n.keyType)||(M.keyType=this.keyTypeOptions$.value[0]);const R=i&&n.targetType===O._K.metadata.app.targetType;R&&n.key!==this.context.appId&&(M.key=this.context.appId),Object.keys(M).length&&this.form.patchValue(M),A.Co.disableControl(this.form.controls.keyType,i&&this.keyTypeOptions$.value.length<=1),A.Co.disableControl(this.form.controls.key,R)})),this.viewModel$=(0,m.E)([(0,m.E)([this.guidedMode$,this.keyTypeOptions$,this.scopeOptions$,this.contentItems$,this.contentTypes$]),(0,m.E)([e,this.guidedKey$])]).pipe((0,T.k)(([[n,i,s,E,M],[R,F]])=>({guidedMode:n,unknownTargetType:!this.targetTypeOptions.some(U=>U.targetType===R.targetType),targetTypeHint:n&&this.targetTypeOptions.find(U=>U.targetType===R.targetType)?.hint,keyTypeOptions:i,scopeOptions:s,guidedKey:F,guidedKeyExists:[O._K.metadata.entity.targetType,O._K.metadata.contentType.targetType].includes(R.targetType),formValues:R,contentItems:E,contentTypes:M})))}ngOnDestroy(){this.guidedMode$.complete(),this.keyTypeOptions$.complete(),this.contentItems$.complete(),this.contentTypes$.complete(),this.guidedKey$.complete(),super.ngOnDestroy()}closeDialog(e){this.dialogRef.close(e)}toggleGuidedKey(e){this.guidedKey$.next(e)}toggleGuidedMode(e){this.guidedMode$.next(e.checked)}confirm(){const e=this.form.getRawValue(),n={target:this.targetTypeOptions.find(i=>i.targetType===e.targetType)?.target,targetType:e.targetType,keyType:e.keyType,key:e.keyType===O._K.keyTypes.guid?e.key.replace(/{|}/g,""):e.key.toString()};this.closeDialog(n)}fetchContentTypes(e){this.contentTypesService.retrieveContentTypes(e).subscribe(n=>{this.contentTypes$.next(n)})}fetchScopes(){this.contentTypesService.getScopes().subscribe(e=>{this.scopeOptions$.next(e)})}static#t=this.\u0275fac=function(n){return new(n||o)(t.GI1(Y.yI),t.GI1(_t.e),t.GI1(J.q),t.GI1(mt.Xi))};static#e=this.\u0275cmp=t.In1({type:o,selectors:[["app-create-metadata-dialog"]],hostVars:1,hostBindings:function(n,i){2&n&&t.SoX("className",i.hostClass)},features:[t.eg9],decls:2,vars:3,consts:[["class","eav-dialog"],[1,"eav-dialog"],[1,"eav-dialog-header"],[1,"eav-dialog-header__title"],[1,"eav-dialog-content"],["href","https://go.2sxc.org/metadata","target","_blank"],[3,"formGroup"],["color","accent",1,"eav-form-field"],["formControlName","targetType","required",""],["matInput","","type","number","min","0","formControlName","targetType","required",""],[3,"isError"],["formControlName","keyType","required",""],["color","accent","class","eav-form-field"],["href","https://2sxc.org/help?tag=scope","target","_blank","appClickStopPropagation",""],["defaultKeyInput",""],["matTextSuffix","","class","eav-selection-suffix"],[1,"eav-dialog-actions"],["color","accent",3,"tippy","checked","change"],["mat-raised-button","","type","button",3,"click"],["mat-raised-button","","type","button","color","accent",3,"disabled","click"],[3,"value"],["formControlName","contentTypeForContentItems",3,"placeholder"],["formControlName","scopeForContentTypes",3,"placeholder"],["formControlName","key","required","",3,"placeholder"],["matInput","","type","text","formControlName","key","required",""],[4,"ngTemplateOutlet"],["matInput","","type","number","formControlName","key","required",""],["matTextSuffix","",1,"eav-selection-suffix"],["mat-icon-button","","type","button","tippy","Pick existing value",1,"eav-selection-suffix-button",3,"ngClass","click"],[1,"eav-icon"],["mat-icon-button","","type","button","tippy","Manual entry",1,"eav-selection-suffix-button",3,"ngClass","click"]],template:function(n,i){if(1&n&&(t.yuY(0,ne,52,19,"div",0),t.wVc(1,"async")),2&n){let s;t.C0Y(0,(s=t.kDX(1,1,i.viewModel$))?0:-1,s)}},dependencies:[S.QF,S.XV,gt.o,ft.c,k.Y,Y.Yp,B.Gw,B.um,W.qL,C.sz,C.ot,C.O4,C.ue,C.u,C.eJ,C.Gu,P.yi,v.Up,v.w5,v.Gm,yt.kX,V.I5,C.uW,C.Wo,vt.cP,S.a]})}return o})();var Z=a(1232);let ae=(()=>{class o{constructor(){this.published="",this.metadata="",this.hasMetadata=""}agInit(e){this.filterParams=e}isFilterActive(){return""!==this.published||""!==this.metadata||""!==this.hasMetadata}doesFilterPass(e){let n=!1,i=!1,s=!1;const M=this.filterParams.valueGetter({api:this.filterParams.api,colDef:this.filterParams.colDef,column:this.filterParams.column,columnApi:this.filterParams.columnApi,context:this.filterParams.context,data:e.node.data,getValue:R=>e.node.data[R],node:e.node});return n=""===this.published||null!=M.published&&M.published.toString()===this.published,i=""===this.metadata||null!=M.metadata&&M.metadata.toString()===this.metadata,s=""===this.hasMetadata||null!=M.hasMetadata&&M.hasMetadata.toString()===this.hasMetadata,n&&i&&s}getModel(){return this.isFilterActive()?{filterType:"pub-meta",published:this.published,metadata:this.metadata,hasMetadata:this.hasMetadata}:void 0}setModel(e){this.published=e?e.published:"",this.metadata=e?e.metadata:"",this.hasMetadata=e?e.hasMetadata:""}afterGuiAttached(e){}filterChanged(){this.filterParams.filterChangedCallback()}static#t=this.\u0275fac=function(n){return new(n||o)};static#e=this.\u0275cmp=t.In1({type:o,selectors:[["app-pub-meta-filter"]],decls:27,vars:3,consts:[[1,"title"],[3,"ngModel","ngModelChange"],["value",""],["value","true"],["value","false"]],template:function(n,i){1&n&&(t.I0R(0,"div",0),t.OEk(1,"Published"),t.C$Y(),t.I0R(2,"mat-radio-group",1),t.qCj("ngModelChange",function(E){return i.published=E})("ngModelChange",function(){return i.filterChanged()}),t.I0R(3,"mat-radio-button",2),t.OEk(4,"All"),t.C$Y(),t.I0R(5,"mat-radio-button",3),t.OEk(6,"Published"),t.C$Y(),t.I0R(7,"mat-radio-button",4),t.OEk(8,"Not published"),t.C$Y()(),t.I0R(9,"div",0),t.OEk(10,"Is Metadata"),t.C$Y(),t.I0R(11,"mat-radio-group",1),t.qCj("ngModelChange",function(E){return i.metadata=E})("ngModelChange",function(){return i.filterChanged()}),t.I0R(12,"mat-radio-button",2),t.OEk(13,"All"),t.C$Y(),t.I0R(14,"mat-radio-button",3),t.OEk(15,"Is metadata"),t.C$Y(),t.I0R(16,"mat-radio-button",4),t.OEk(17,"Is not metadata"),t.C$Y()(),t.I0R(18,"div",0),t.OEk(19,"Has Metadata"),t.C$Y(),t.I0R(20,"mat-radio-group",1),t.qCj("ngModelChange",function(E){return i.hasMetadata=E})("ngModelChange",function(){return i.filterChanged()}),t.I0R(21,"mat-radio-button",2),t.OEk(22,"All"),t.C$Y(),t.I0R(23,"mat-radio-button",3),t.OEk(24,"Has metadata"),t.C$Y(),t.I0R(25,"mat-radio-button",4),t.OEk(26,"Has no metadata"),t.C$Y()()),2&n&&(t.yG2(2),t.E7m("ngModel",i.published),t.yG2(9),t.E7m("ngModel",i.metadata),t.yG2(9),t.E7m("ngModel",i.hasMetadata))},dependencies:[C.ue,C._G,Z.cv,Z.cT],styles:[".title[_ngcontent-%COMP%]{padding:12px 12px 0}.mat-mdc-radio-group[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:space-between;overflow:hidden;padding:12px;width:160px;height:104px}"]})}return o})();var ie=a(4328),Q=a(5204),se=a(4648),re=a(3884),le=a(2564),ce=a(4072),de=a(48);function pe(o,l){1&o&&(t.wR5(0,"div",6),t.wVc(1,"safeHtml")),2&o&&t.E7m("innerHTML",t.kDX(1,1,l),t.E3n)}function me(o,l){if(1&o){const e=t.KQA();t.I0R(0,"button",18),t.qCj("click",function(){t.usT(e);const i=t.GaO(2);return t.CGJ(i.debugFilter())}),t.I0R(1,"mat-icon",12),t.OEk(2,"filter_list"),t.C$Y(),t.I0R(3,"span"),t.OEk(4,"Filter"),t.C$Y()()}}function ue(o,l){if(1&o){const e=t.KQA();t.I0R(0,"div",1)(1,"div",2)(2,"div",3),t.OEk(3),t.C$Y(),t.I0R(4,"button",4),t.qCj("click",function(){t.usT(e);const i=t.GaO();return t.CGJ(i.closeDialog())}),t.I0R(5,"mat-icon"),t.OEk(6,"close"),t.C$Y()()(),t.I0R(7,"div",5),t.wR5(8,"router-outlet"),t.yuY(9,pe,2,3,"div",6),t.I0R(10,"div",7)(11,"ag-grid-angular",8),t.qCj("gridReady",function(i){t.usT(e);const s=t.GaO();return t.CGJ(s.onGridReady(i))})("filesDropped",function(i){t.usT(e);const s=t.GaO();return t.CGJ(s.filesDropped(i))}),t.C$Y()()(),t.I0R(12,"mat-dialog-actions",9)(13,"div",10)(14,"button",11),t.qCj("click",function(){t.usT(e);const i=t.GaO();return t.CGJ(i.exportContent())}),t.I0R(15,"mat-icon",12),t.OEk(16,"cloud_download"),t.C$Y(),t.I0R(17,"span"),t.OEk(18,"Data"),t.C$Y()(),t.I0R(19,"button",13),t.qCj("click",function(){t.usT(e);const i=t.GaO();return t.CGJ(i.importContent())}),t.I0R(20,"mat-icon",12),t.OEk(21,"cloud_upload"),t.C$Y(),t.I0R(22,"span"),t.OEk(23,"Data"),t.C$Y()(),t.I0R(24,"button",14),t.qCj("click",function(){t.usT(e);const i=t.GaO();return t.CGJ(i.importItem())}),t.I0R(25,"mat-icon",12),t.OEk(26,"cloud_upload"),t.C$Y(),t.I0R(27,"span"),t.OEk(28,"Item"),t.C$Y()(),t.I0R(29,"button",15),t.qCj("click",function(){t.usT(e);const i=t.GaO();return t.CGJ(i.createMetadata())}),t.I0R(30,"mat-icon",12),t.OEk(31,"local_offer"),t.C$Y(),t.I0R(32,"span"),t.OEk(33,"Create Metadata"),t.C$Y()(),t.yuY(34,me,5,0,"button",16),t.C$Y(),t.I0R(35,"button",17),t.qCj("click",function(){t.usT(e);const i=t.GaO();return t.CGJ(i.editItem(null))}),t.I0R(36,"mat-icon"),t.OEk(37,"add"),t.C$Y()()()()}if(2&o){const e=t.GaO();let n;t.yG2(3),t.oRS(" ",l.contentType.Label||l.contentType.Name," Data "),t.yG2(6),t.C0Y(9,(n=null==l.contentType||null==l.contentType.Properties?null:l.contentType.Properties.ListInstructions)?9:-1,n),t.yG2(2),t.E7m("rowData",l.items)("gridOptions",e.gridOptions)("allowedFileTypes","xml,json"),t.yG2(23),t.C0Y(34,l.debugEnabled?34:-1)}}let _e=(()=>{class o extends d.K{constructor(e,n,i,s,E,M,R,F,N,U,he,Ce){super(e,n),this.router=e,this.route=n,this.dialogRef=i,this.contentTypesService=s,this.contentItemsService=E,this.entitiesService=M,this.contentExportService=R,this.snackBar=F,this.globalConfigService=N,this.dialog=U,this.viewContainerRef=he,this.changeDetectorRef=Ce,this.contentType$=new r.E,this.items$=new c.g(void 0),this.gridOptions={...b.A},this.gridApi$=new c.g(null),this.contentTypeStaticName=this.route.snapshot.paramMap.get("contentTypeStaticName")}ngOnInit(){this.fetchContentType(),this.fetchItems(),this.fetchColumns(),this.subscription.add(this.refreshOnChildClosedShallow().subscribe(()=>{this.fetchItems()})),this.viewModel$=(0,m.E)([this.contentType$,this.items$,this.globalConfigService.getDebugEnabled$()]).pipe((0,T.k)(([e,n,i])=>({contentType:e,items:n,debugEnabled:i})))}ngOnDestroy(){this.contentType$.complete(),this.items$.complete(),this.gridApi$.complete(),super.ngOnDestroy()}closeDialog(){this.dialogRef.close()}onGridReady(e){this.gridApi$.next(e.api)}fetchContentType(){this.contentTypesService.retrieveContentType(this.contentTypeStaticName).subscribe(e=>{this.contentType$.next(e)})}fetchItems(){this.contentItemsService.getAll(this.contentTypeStaticName).subscribe(e=>{this.items$.next(e)})}fetchColumns(){this.contentItemsService.getColumns(this.contentTypeStaticName).subscribe(e=>{const n=e.filter(E=>!E.IsEphemeral),i=this.buildColumnDefs(n),s=function dt(o,l){if(!o)return;let e;"="===o.charAt(o.length-1)&&(o=atob(o));try{e=JSON.parse(o)}catch{console.error("Can't parse JSON with filters from url:",o)}if(!e)return;const n={};return(e.IsPublished||e.IsMetadata)&&(n.Status={filterType:"pub-meta",published:e.IsPublished??"",metadata:e.IsMetadata??"",hasMetadata:""}),Object.entries(e).filter(([i,s])=>"IsPublished"!==i&&"IsMetadata"!==i).forEach(([i,s])=>{if(l.find(M=>M.headerName===i)?.filter!==G){if("string"==typeof s)n[i]={filterType:"text",type:"equals",filter:s};else if("number"==typeof s)n[i]={filterType:"number",type:"equals",filter:s,filterTo:null};else if("boolean"==typeof s){const M={filterType:"boolean",filter:s.toString()};n[i]=M}}else{const M={filterType:"entity",filter:"string"==typeof(s=A.Co.tryParse(s)??s)?s:void 0,idFilter:"number"==typeof s?[s]:Array.isArray(s)?s.filter(R=>"number"==typeof R):void 0};n[i]=M}}),n}(sessionStorage.getItem(L.cX),i);this.gridApi$.value?this.setColumnDefs(i,s):this.gridApi$.pipe((0,g.I)(E=>null!=E),(0,_.U)(1)).subscribe(E=>{this.setColumnDefs(i,s)})})}setColumnDefs(e,n){this.gridApi$.value.setColumnDefs(e),n&&((0,tt.y)("Will try to apply filter:",n),this.gridApi$.value.setFilterModel(n))}openMetadata(e){const n=y.K.getUrlEntity(e.Guid,`Metadata for Entity: ${e._Title} (${e.Id})`,this.contentTypeStaticName);this.router.navigate([n],{relativeTo:this.route})}editItem(e){const i=(0,j.K)({items:[null==e?{ContentTypeName:this.contentTypeStaticName}:{EntityId:e.Id}]});this.router.navigate([`edit/${i}`],{relativeTo:this.route})}exportContent(){const e=this.gridApi$.value.getFilterModel(),n=Object.keys(e).length>0,i=[];n&&this.gridApi$.value.forEachNodeAfterFilterAndSort(s=>{i.push(s.data.Id)}),this.router.navigate([`export/${this.contentTypeStaticName}${i.length>0?`/${i}`:""}`],{relativeTo:this.route})}filesDropped(e){const n=e[0];switch(n.name.substring(n.name.lastIndexOf(".")+1).toLocaleLowerCase()){case"xml":this.importContent(e);break;case"json":this.importItem(e)}}importContent(e){this.router.navigate([`${this.contentTypeStaticName}/import`],{relativeTo:this.route,state:{files:e}})}importItem(e){this.router.navigate(["import"],{relativeTo:this.route,state:{files:e}})}createMetadata(){this.dialog.open(oe,{autoFocus:!1,viewContainerRef:this.viewContainerRef,width:"650px"}).afterClosed().subscribe(n=>{if(null==n)return;const i={items:[{ContentTypeName:this.contentTypeStaticName,For:{Target:n.target??n.targetType.toString(),TargetType:n.targetType,...n.keyType===O._K.keyTypes.guid&&{Guid:n.key},...n.keyType===O._K.keyTypes.number&&{Number:parseInt(n.key,10)},...n.keyType===O._K.keyTypes.string&&{String:n.key}}}]},s=(0,j.K)(i);this.router.navigate([`edit/${s}`],{relativeTo:this.route}),this.changeDetectorRef.markForCheck()})}debugFilter(){console.warn("Current filter:",this.gridApi$.value.getFilterModel()),this.snackBar.open("Check console for filter information",void 0,{duration:3e3})}buildColumnDefs(e){const n=[{headerName:"ID",field:"Id",width:70,headerClass:"dense",sortable:!0,filter:"agNumberColumnFilter",cellClass:i=>("id-action no-padding no-outline "+(i.data._EditInfo.ReadOnly?"disabled":"")).split(" "),valueGetter:i=>i.data.Id,cellRenderer:q.q,cellRendererParams:{tooltipGetter:s=>`ID: ${s.Id}\nRepoID: ${s._RepositoryId}\nGUID: ${s.Guid}`}},{field:"Status",width:82,headerClass:"dense",cellClass:"secondary-action no-padding".split(" "),filter:ae,valueGetter:i=>{const s=i.data;return{published:s.IsPublished,metadata:!!s.For,hasMetadata:!!s.Metadata&&s.Metadata.length>0}},cellRenderer:ct,cellRendererParams:{onOpenMetadata:s=>this.openMetadata(s)}},{headerName:"Item (Entity)",field:"_Title",flex:2,minWidth:250,cellClass:"primary-action highlight".split(" "),sortable:!0,filter:"agTextColumnFilter",onCellClicked:i=>{this.editItem(i.data)},valueGetter:i=>i.data._Title},{headerName:"Stats",headerTooltip:"Used by others / uses others",field:"_Used",width:70,headerClass:"dense",cellClass:"no-outline",sortable:!0,filter:"agTextColumnFilter",valueGetter:i=>{const s=i.data;return`${s._Used} / ${s._Uses}`}},{cellClass:"secondary-action no-padding".split(" "),width:122,pinned:"right",cellRenderer:nt,cellRendererParams:{onClone:s=>this.clone(s),onExport:s=>this.export(s),onDelete:s=>this.delete(s)}}];for(const i of e){const s={headerName:i.StaticName,field:i.StaticName,flex:2,minWidth:250,cellClass:"no-outline",sortable:!0};switch(i.Type){case h.m.Entity:s.allowMultiValue=i.Metadata?.Entity?.AllowMultiValue??!0,s.cellRenderer=at,s.valueGetter=this.valueGetterEntityField,s.filter=G;break;case h.m.DateTime:s.useTimePicker=i.Metadata?.DateTime?.UseTimePicker??!1,s.valueGetter=this.valueGetterDateTime,s.filter="agTextColumnFilter";break;case h.m.Boolean:s.valueGetter=this.valueGetterBoolean,s.filter=D.s;break;case h.m.Number:s.filter="agNumberColumnFilter";break;default:s.filter="agTextColumnFilter"}n.push(s)}return n}clone(e){const i=(0,j.K)({items:[{ContentTypeName:this.contentTypeStaticName,DuplicateEntity:e.Id}]});this.router.navigate([`edit/${i}`],{relativeTo:this.route})}export(e){this.contentExportService.exportEntity(e.Id,this.contentTypeStaticName,!0)}delete(e){confirm(`Delete '${e._Title}' (${e._RepositoryId})?`)&&(this.snackBar.open("Deleting..."),this.entitiesService.delete(this.contentTypeStaticName,e._RepositoryId,!1).subscribe({next:()=>{this.snackBar.open("Deleted",null,{duration:2e3}),this.fetchItems()},error:n=>{this.snackBar.dismiss(),confirm(`${n.error.ExceptionMessage}\n\nDo you want to force delete '${e._Title}' (${e._RepositoryId})?`)&&(this.snackBar.open("Deleting..."),this.entitiesService.delete(this.contentTypeStaticName,e._RepositoryId,!0).subscribe(()=>{this.snackBar.open("Deleted",null,{duration:2e3}),this.fetchItems()}))}}))}valueGetterEntityField(e){const n=e.data[e.colDef.field];return 0===n.length?null:n.map(i=>i.Title)}valueGetterDateTime(e){const n=e.data[e.colDef.field];return n?e.colDef.useTimePicker?n.replace("T"," ").replace("Z",""):n.split("T")[0]:null}valueGetterBoolean(e){const n=e.data[e.colDef.field];return"boolean"!=typeof n?null:n.toString()}static#t=this.\u0275fac=function(n){return new(n||o)(t.GI1(Q.E5),t.GI1(Q.gV),t.GI1(Y.yI),t.GI1(p.X),t.GI1(J.q),t.GI1(ie.q),t.GI1(I.M),t.GI1(se.yS),t.GI1(u.Sq),t.GI1(Y.qW),t.GI1(t.y8U),t.GI1(t.kD9))};static#e=this.\u0275cmp=t.In1({type:o,selectors:[["app-content-items"]],features:[t.eg9],decls:2,vars:3,consts:[["appToggleDebug","","class","eav-dialog nav-component-wrapper"],["appToggleDebug","",1,"eav-dialog","nav-component-wrapper"],[1,"eav-dialog-header"],[1,"eav-dialog-header__title"],["mat-icon-button","","tippy","Close dialog",3,"click"],[1,"eav-dialog-content","nav-component-wrapper"],[3,"innerHTML"],[1,"grid-wrapper"],["appDragAndDrop","",1,"ag-theme-material",3,"rowData","gridOptions","allowedFileTypes","gridReady","filesDropped"],[1,"eav-dialog-actions"],[1,"eav-dialog-actions-div"],["mat-button","","tippy","Export xml list",1,"eav-button__with-icon",3,"click"],[1,"eav-icon"],["mat-button","","tippy","Import xml list",1,"eav-button__with-icon",3,"click"],["mat-button","","tippy","Import single json item",1,"eav-button__with-icon",3,"click"],["mat-button","","tippy","Create metadata",1,"eav-button__with-icon",3,"click"],["mat-button","","class","eav-button__with-icon","color","accent","tippy","Print filter to console"],["mat-fab","","mat-elevation-z24","","tippy","Add item",1,"grid-fab",3,"click"],["mat-button","","color","accent","tippy","Print filter to console",1,"eav-button__with-icon",3,"click"]],template:function(n,i){if(1&n&&(t.yuY(0,ue,38,6,"div",0),t.wVc(1,"async")),2&n){let s;t.C0Y(0,(s=t.kDX(1,1,i.viewModel$))?0:-1,s)}},dependencies:[Q.cP,re.Q,le.U,k.Y,Y.Yp,B.Gw,B.um,B.uw,W.qL,ce.U5,S.a,de.K]})}return o})()},5343:(x,f,a)=>{a.d(f,{i:()=>I,t:()=>h});var r=a(9432),c=a(8916),m=a(8288),T=a(6028),g=a(4896),_=a(1332),p=a(3392);const I="admin/app/";let h=(()=>{class u{constructor(d,D,t){this.http=d,this.context=D,this.dnnContext=t}importApp(d,D,t=!1){const v=new FormData;return v.append("File",d),v.append("Name",D??""),this.http.post(this.dnnContext.$2sxc.http.apiUrl(I+"Import"),v,{params:{zoneId:this.context.zoneId.toString()}}).pipe((0,r.G)(C=>{if(t&&C.Messages[0]?.MessageType===m.cB.Warning){const P=prompt(C.Messages[0].Text+" Would you like to install it using another folder name?");if(P)return this.importApp(d,P,!0)}return(0,c.of)(C)}))}static#t=this.\u0275fac=function(D){return new(D||u)(g.CoB(_.KK),g.CoB(T.e),g.CoB(p.es))};static#e=this.\u0275prov=g.wxM({token:u,factory:u.\u0275fac})}return u})()},2816:(x,f,a)=>{a.d(f,{K:()=>I});var r=a(5204),c=a(6560),m=a(1792),T=a(604),g=a(6536),_=a(6884),p=a(4896);let I=(()=>{class h extends _.C{constructor(y,d){super(),this.router=y,this.route=d}ngOnDestroy(){super.ngOnDestroy()}refreshOnChildClosedShallow(){return this.router.events.pipe((0,c.I)(y=>y instanceof r.cf),(0,m.W)(!!this.route.snapshot.firstChild),(0,T.k)(()=>!!this.route.snapshot.firstChild),(0,g.c)(),(0,c.I)(([y,d])=>y&&!d))}static#t=this.\u0275fac=function(d){return new(d||h)(p.GI1(r.E5),p.GI1(r.gV))};static#e=this.\u0275dir=p.Sc5({type:h,features:[p.eg9]})}return h})()},5960:(x,f,a)=>{a.d(f,{s:()=>T});var r=a(4896),c=a(1904),m=a(1232);let T=(()=>{class g{constructor(){this.filter=""}agInit(p){this.filterParams=p}isFilterActive(){return""!==this.filter}doesFilterPass(p){const h=this.filterParams.valueGetter({api:this.filterParams.api,colDef:this.filterParams.colDef,column:this.filterParams.column,columnApi:this.filterParams.columnApi,context:this.filterParams.context,data:p.node.data,getValue:u=>p.node.data[u],node:p.node});return null!=h&&h.toString()===this.filter}getModel(){if(this.isFilterActive())return{filterType:"boolean",filter:this.filter}}setModel(p){this.filter=p?p.filter:""}afterGuiAttached(p){}filterChanged(){this.filterParams.filterChangedCallback()}static#t=this.\u0275fac=function(I){return new(I||g)};static#e=this.\u0275cmp=r.In1({type:g,selectors:[["app-boolean-filter"]],decls:7,vars:1,consts:[[3,"ngModel","ngModelChange"],["value",""],["value","true"],["value","false"]],template:function(I,h){1&I&&(r.I0R(0,"mat-radio-group",0),r.qCj("ngModelChange",function(y){return h.filter=y})("ngModelChange",function(){return h.filterChanged()}),r.I0R(1,"mat-radio-button",1),r.OEk(2,"All"),r.C$Y(),r.I0R(3,"mat-radio-button",2),r.OEk(4,"True"),r.C$Y(),r.I0R(5,"mat-radio-button",3),r.OEk(6,"False"),r.C$Y()()),2&I&&r.E7m("ngModel",h.filter)},dependencies:[c.ue,c._G,m.cv,m.cT],styles:[".mat-mdc-radio-group[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:space-between;overflow:hidden;padding:12px;width:160px;height:104px}"]})}return g})()},9084:(x,f,a)=>{a.d(f,{o:()=>y});var r=a(4896),c=a(5056),m=a(244);function T(d,D){1&d&&r.C_f(0)}function g(d,D){if(1&d&&(r.I0R(0,"mat-hint"),r.yuY(1,T,1,0,"ng-container",2),r.C$Y()),2&d){r.GaO();const t=r.Gew(4);r.yG2(1),r.E7m("ngTemplateOutlet",t)}}function _(d,D){1&d&&r.C_f(0)}function p(d,D){if(1&d&&(r.I0R(0,"mat-error"),r.yuY(1,_,1,0,"ng-container",2),r.C$Y()),2&d){r.GaO();const t=r.Gew(4);r.yG2(1),r.E7m("ngTemplateOutlet",t)}}function I(d,D){1&d&&r._Xx(0)}const h=d=>({"hint-box__short":d}),u=["*"];let y=(()=>{class d{constructor(){this.isError=!1,this.isShort=!0}toggleIsShort(){this.isShort=!this.isShort}static#t=this.\u0275fac=function(v){return new(v||d)};static#e=this.\u0275cmp=r.In1({type:d,selectors:[["app-field-hint"]],inputs:{isError:"isError"},ngContentSelectors:u,decls:5,vars:4,consts:[[1,"hint-box",3,"ngClass","click"],["content",""],[4,"ngTemplateOutlet"]],template:function(v,C){if(1&v&&(r.kPM(),r.I0R(0,"div",0),r.qCj("click",function(){return C.toggleIsShort()}),r.yuY(1,g,2,1)(2,p,2,1),r.C$Y(),r.yuY(3,I,1,0,"ng-template",null,1,r.gJz)),2&v){let P;r.E7m("ngClass",r.S45(2,h,C.isShort)),r.yG2(1),r.C0Y(1,!1===(P=C.isError)?1:!0===P?2:-1)}},dependencies:[c.QF,c.XV,m.MX,m.wJ],styles:[".hint-box[_ngcontent-%COMP%]{margin-top:4px}.hint-box[_ngcontent-%COMP%]   .mat-mdc-form-field-hint[_ngcontent-%COMP%], .hint-box[_ngcontent-%COMP%]   .mat-mdc-form-field-error[_ngcontent-%COMP%]{font-size:12px;display:block}.hint-box__short[_ngcontent-%COMP%]   .mat-mdc-form-field-hint[_ngcontent-%COMP%], .hint-box__short[_ngcontent-%COMP%]   .mat-mdc-form-field-error[_ngcontent-%COMP%]{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}"]})}return d})()},5760:(x,f,a)=>{a.d(f,{q:()=>h});var r=a(2556),c=a(4896),m=a(4648),T=a(5056),g=a(6176),_=a(2328),p=a(8200);const I=(u,y)=>({"align-start":u,"align-end":y});let h=(()=>{class u{constructor(d){this.snackBar=d}agInit(d){this.id=d.value,this.align="number"==typeof this.id?"end":"start",this.tooltip=d.tooltipGetter(d.data)}refresh(d){return!0}copy(){(0,r.y)(this.tooltip),this.snackBar.open("Copied to clipboard",null,{duration:2e3})}static#t=this.\u0275fac=function(D){return new(D||u)(c.GI1(m.yS))};static#e=this.\u0275cmp=c.In1({type:u,selectors:[["app-id-field"]],decls:5,vars:6,consts:[["matRipple","",1,"id-box","highlight",3,"tippy","ngClass","click"],[1,"id"],[1,"icon"]],template:function(D,t){1&D&&(c.I0R(0,"div",0),c.qCj("click",function(){return t.copy()}),c.I0R(1,"span",1),c.OEk(2),c.C$Y(),c.I0R(3,"mat-icon",2),c.OEk(4,"file_copy"),c.C$Y()()),2&D&&(c.E7m("tippy",t.tooltip)("ngClass",c.IBC(3,I,"start"===t.align,"end"===t.align)),c.yG2(2),c.cNF(t.id))},dependencies:[T.QF,g.UZ,_.qL,p.Y],styles:[".id-box[_ngcontent-%COMP%]{padding:0 8px;height:100%;display:flex;align-items:center}.id-box.align-start[_ngcontent-%COMP%]{justify-content:flex-start}.id-box.align-end[_ngcontent-%COMP%]{justify-content:flex-end}.id-box[_ngcontent-%COMP%]   .id[_ngcontent-%COMP%]{max-width:100%;text-overflow:ellipsis;overflow:hidden}.id-box[_ngcontent-%COMP%]:hover{text-decoration:none}.id-box[_ngcontent-%COMP%]:hover   .id[_ngcontent-%COMP%]{display:none}.id-box[_ngcontent-%COMP%]:not(:hover)   .icon[_ngcontent-%COMP%]{display:none}"]})}return u})()},1743:(x,f,a)=>{a.d(f,{A:()=>r});const r={accentedSort:!0,animateRows:!0,enableCellTextSelection:!0,headerHeight:32,suppressScrollOnNewData:!0,valueCache:!0,defaultColDef:{filterParams:{newRowsAction:"keep"}},tooltipShowDelay:0,tooltipHideDelay:1e5,suppressMovableColumns:!0}},420:(x,f,a)=>{a.d(f,{M:()=>r});const r="DROPDOWN_INSERT_VALUE"},2260:(x,f,a)=>{function r(){return/^[a-f0-9]{8}(?:-[a-f0-9]{4}){3}-[a-f0-9]{12}$/i}a.d(f,{y:()=>r})},504:(x,f,a)=>{a.d(f,{c:()=>c});var r=a(4896);let c=(()=>{class m{onClick(g){g.stopPropagation()}static#t=this.\u0275fac=function(_){return new(_||m)};static#e=this.\u0275dir=r.Sc5({type:m,selectors:[["","appClickStopPropagation",""]],hostBindings:function(_,p){1&_&&r.qCj("click",function(h){return p.onClick(h)})}})}return m})()},2564:(x,f,a)=>{a.d(f,{U:()=>m});var r=a(5200),c=a(4896);let m=(()=>{class T{constructor(_){this.globalConfigService=_}onClick(_){(navigator.platform.match("Mac")?_.metaKey:_.ctrlKey)&&_.shiftKey&&_.altKey&&(this.globalConfigService.toggleDebugEnabled(),window.getSelection().removeAllRanges())}static#t=this.\u0275fac=function(p){return new(p||T)(c.GI1(r.Sq))};static#e=this.\u0275dir=c.Sc5({type:T,selectors:[["","appToggleDebug",""]],hostBindings:function(p,I){1&p&&c.qCj("click",function(u){return I.onClick(u)})}})}return T})()},2556:(x,f,a)=>{function r(c){const m=document.createElement("textarea");m.value=c,m.setAttribute("readonly",""),m.style.position="absolute",m.style.left="-9999px",document.body.appendChild(m);const T=document.getSelection().rangeCount>0&&document.getSelection().getRangeAt(0);m.select(),document.execCommand("copy"),document.body.removeChild(m),T&&(document.getSelection().removeAllRanges(),document.getSelection().addRange(T))}a.d(f,{y:()=>r})}}]);
//# sourceMappingURL=https://sources.2sxc.org/17.04.00/dist/ng-edit/projects_eav-ui_src_app_content-items_content-items_component_ts.3e79c82bfd2d0100.js.map