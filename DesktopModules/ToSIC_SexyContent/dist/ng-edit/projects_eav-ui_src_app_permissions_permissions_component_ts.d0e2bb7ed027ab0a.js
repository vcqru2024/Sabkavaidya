"use strict";(self.webpackChunkeav_ui=self.webpackChunkeav_ui||[]).push([["projects_eav-ui_src_app_permissions_permissions_component_ts"],{724:(O,m,e)=>{e.r(m),e.d(m,{PermissionsComponent:()=>x});var c=e(4844),o=e(5876),r=e(604),h=e(2816),v=e(5760),f=e(1743),l=e(9224),P=e(5396),t=e(4896),u=e(8200),p=e(2328),a=e(6176);let y=(()=>{class d{agInit(i){this.params=i}refresh(i){return!0}deletePermission(){this.params.onDelete(this.params.data)}static#t=this.\u0275fac=function(n){return new(n||d)};static#e=this.\u0275cmp=t.In1({type:d,selectors:[["app-permissions-actions"]],decls:4,vars:0,consts:[[1,"actions-component"],["matRipple","","tippy","Delete",1,"eav-grid-action-button","highlight",3,"click"]],template:function(n,s){1&n&&(t.I0R(0,"div",0)(1,"div",1),t.qCj("click",function(){return s.deletePermission()}),t.I0R(2,"mat-icon"),t.OEk(3,"delete"),t.C$Y()()())},dependencies:[u.Y,p.qL,a.UZ]})}return d})();var g=e(896),I=e(5204),_=e(600),E=e(4648),T=e(4672),D=e(4072),M=e(5056);function R(d,G){if(1&d){const i=t.KQA();t.I0R(0,"div",1)(1,"div",2)(2,"div",3),t.OEk(3,"Permissions"),t.C$Y(),t.I0R(4,"button",4),t.qCj("click",function(){t.usT(i);const s=t.GaO();return t.CGJ(s.closeDialog())}),t.I0R(5,"mat-icon"),t.OEk(6,"close"),t.C$Y()()(),t.I0R(7,"div",5),t.wR5(8,"router-outlet"),t.I0R(9,"div",6),t.wR5(10,"ag-grid-angular",7),t.C$Y(),t.I0R(11,"mat-dialog-actions",8)(12,"button",9),t.qCj("click",function(){t.usT(i);const s=t.GaO();return t.CGJ(s.editPermission(null))}),t.I0R(13,"mat-icon"),t.OEk(14,"add"),t.C$Y()()()()()}if(2&d){const i=t.GaO();t.yG2(10),t.E7m("rowData",G.permissions)("gridOptions",i.gridOptions)}}let x=(()=>{class d extends h.K{constructor(i,n,s,C,b){super(i,n),this.router=i,this.route=n,this.dialogRef=s,this.permissionsService=C,this.snackBar=b,this.permissions$=new c.g(void 0),this.gridOptions=this.buildGridOptions(),this.targetType=parseInt(this.route.snapshot.paramMap.get("targetType"),10),this.keyType=this.route.snapshot.paramMap.get("keyType"),this.key=this.route.snapshot.paramMap.get("key"),this.prefills={[l._K.metadata.language.targetType]:{PermissionType:"language"}}}ngOnInit(){this.fetchPermissions(),this.subscription.add(this.refreshOnChildClosedShallow().subscribe(()=>{this.fetchPermissions()})),this.viewModel$=(0,o.E)([this.permissions$]).pipe((0,r.k)(([i])=>({permissions:i})))}ngOnDestroy(){this.permissions$.complete(),super.ngOnDestroy()}closeDialog(){this.dialogRef.close()}fetchPermissions(){this.permissionsService.getAll(this.targetType,this.keyType,this.key).subscribe(i=>{this.permissions$.next(i)})}editPermission(i){let n;n=null==i?{items:[{ContentTypeName:l._K.contentTypes.permissions,For:{Target:Object.values(l._K.metadata).find(C=>C.targetType===this.targetType)?.target??this.targetType.toString(),TargetType:this.targetType,...this.keyType===l._K.keyTypes.guid&&{Guid:this.key},...this.keyType===l._K.keyTypes.number&&{Number:parseInt(this.key,10)},...this.keyType===l._K.keyTypes.string&&{String:this.key}},...this.prefills[this.targetType]&&{Prefill:this.prefills[this.targetType]}}]}:{items:[{EntityId:i.Id}]};const s=(0,P.K)(n);this.router.navigate([`edit/${s}`],{relativeTo:this.route})}deletePermission(i){confirm(`Delete '${i.Title}' (${i.Id})?`)&&(this.snackBar.open("Deleting..."),this.permissionsService.delete(i.Id).subscribe(()=>{this.snackBar.open("Deleted",null,{duration:2e3}),this.fetchPermissions()}))}buildGridOptions(){return{...f.A,columnDefs:[{headerName:"ID",field:"Id",width:70,headerClass:"dense",cellClass:"id-action no-padding no-outline".split(" "),sortable:!0,filter:"agNumberColumnFilter",valueGetter:n=>n.data.Id,cellRenderer:v.q,cellRendererParams:{tooltipGetter:s=>`ID: ${s.Id}\nGUID: ${s.Guid}`}},{field:"Name",flex:2,minWidth:250,cellClass:"primary-action highlight".split(" "),sortable:!0,sort:"asc",filter:"agTextColumnFilter",onCellClicked:n=>{this.editPermission(n.data)},valueGetter:n=>n.data.Title},{field:"Identity",flex:2,minWidth:250,cellClass:"no-outline",sortable:!0,filter:"agTextColumnFilter",valueGetter:n=>n.data.Identity},{field:"Condition",flex:2,minWidth:250,cellClass:"no-outline",sortable:!0,filter:"agTextColumnFilter",valueGetter:n=>n.data.Condition},{field:"Grant",width:70,headerClass:"dense",cellClass:"no-outline",sortable:!0,filter:"agTextColumnFilter",valueGetter:n=>n.data.Grant},{width:42,cellClass:"secondary-action no-padding".split(" "),pinned:"right",cellRenderer:y,cellRendererParams:{onDelete:s=>this.deletePermission(s)}}]}}static#t=this.\u0275fac=function(n){return new(n||d)(t.GI1(I.E5),t.GI1(I.gV),t.GI1(_.yI),t.GI1(g.W),t.GI1(E.yS))};static#e=this.\u0275cmp=t.In1({type:d,selectors:[["app-permissions"]],features:[t.eg9],decls:2,vars:3,consts:[["class","eav-dialog nav-component-wrapper"],[1,"eav-dialog","nav-component-wrapper"],[1,"eav-dialog-header"],[1,"eav-dialog-header__title"],["mat-icon-button","","tippy","Close dialog",3,"click"],[1,"eav-dialog-content","nav-component-wrapper"],[1,"grid-wrapper"],[1,"ag-theme-material",3,"rowData","gridOptions"],["align","end"],["mat-fab","","mat-elevation-z24","","tippy","Create a new permission",1,"grid-fab",3,"click"]],template:function(n,s){if(1&n&&(t.yuY(0,R,15,2,"div",0),t.wVc(1,"async")),2&n){let C;t.C0Y(0,(C=t.kDX(1,1,s.viewModel$))?0:-1,C)}},dependencies:[I.cP,u.Y,_.Yp,T.um,T.uw,p.qL,D.U5,M.a]})}return d})()},2816:(O,m,e)=>{e.d(m,{K:()=>P});var c=e(5204),o=e(6560),r=e(1792),h=e(604),v=e(6536),f=e(6884),l=e(4896);let P=(()=>{class t extends f.C{constructor(p,a){super(),this.router=p,this.route=a}ngOnDestroy(){super.ngOnDestroy()}refreshOnChildClosedShallow(){return this.router.events.pipe((0,o.I)(p=>p instanceof c.cf),(0,r.W)(!!this.route.snapshot.firstChild),(0,h.k)(()=>!!this.route.snapshot.firstChild),(0,v.c)(),(0,o.I)(([p,a])=>p&&!a))}static#t=this.\u0275fac=function(a){return new(a||t)(l.GI1(c.E5),l.GI1(c.gV))};static#e=this.\u0275dir=l.Sc5({type:t,features:[l.eg9]})}return t})()},5760:(O,m,e)=>{e.d(m,{q:()=>t});var c=e(2556),o=e(4896),r=e(4648),h=e(5056),v=e(6176),f=e(2328),l=e(8200);const P=(u,p)=>({"align-start":u,"align-end":p});let t=(()=>{class u{constructor(a){this.snackBar=a}agInit(a){this.id=a.value,this.align="number"==typeof this.id?"end":"start",this.tooltip=a.tooltipGetter(a.data)}refresh(a){return!0}copy(){(0,c.y)(this.tooltip),this.snackBar.open("Copied to clipboard",null,{duration:2e3})}static#t=this.\u0275fac=function(y){return new(y||u)(o.GI1(r.yS))};static#e=this.\u0275cmp=o.In1({type:u,selectors:[["app-id-field"]],decls:5,vars:6,consts:[["matRipple","",1,"id-box","highlight",3,"tippy","ngClass","click"],[1,"id"],[1,"icon"]],template:function(y,g){1&y&&(o.I0R(0,"div",0),o.qCj("click",function(){return g.copy()}),o.I0R(1,"span",1),o.OEk(2),o.C$Y(),o.I0R(3,"mat-icon",2),o.OEk(4,"file_copy"),o.C$Y()()),2&y&&(o.E7m("tippy",g.tooltip)("ngClass",o.IBC(3,P,"start"===g.align,"end"===g.align)),o.yG2(2),o.cNF(g.id))},dependencies:[h.QF,v.UZ,f.qL,l.Y],styles:[".id-box[_ngcontent-%COMP%]{padding:0 8px;height:100%;display:flex;align-items:center}.id-box.align-start[_ngcontent-%COMP%]{justify-content:flex-start}.id-box.align-end[_ngcontent-%COMP%]{justify-content:flex-end}.id-box[_ngcontent-%COMP%]   .id[_ngcontent-%COMP%]{max-width:100%;text-overflow:ellipsis;overflow:hidden}.id-box[_ngcontent-%COMP%]:hover{text-decoration:none}.id-box[_ngcontent-%COMP%]:hover   .id[_ngcontent-%COMP%]{display:none}.id-box[_ngcontent-%COMP%]:not(:hover)   .icon[_ngcontent-%COMP%]{display:none}"]})}return u})()},1743:(O,m,e)=>{e.d(m,{A:()=>c});const c={accentedSort:!0,animateRows:!0,enableCellTextSelection:!0,headerHeight:32,suppressScrollOnNewData:!0,valueCache:!0,defaultColDef:{filterParams:{newRowsAction:"keep"}},tooltipShowDelay:0,tooltipHideDelay:1e5,suppressMovableColumns:!0}},2556:(O,m,e)=>{function c(o){const r=document.createElement("textarea");r.value=o,r.setAttribute("readonly",""),r.style.position="absolute",r.style.left="-9999px",document.body.appendChild(r);const h=document.getSelection().rangeCount>0&&document.getSelection().getRangeAt(0);r.select(),document.execCommand("copy"),document.body.removeChild(r),h&&(document.getSelection().removeAllRanges(),document.getSelection().addRange(h))}e.d(m,{y:()=>c})}}]);
//# sourceMappingURL=https://sources.2sxc.org/17.04.00/dist/ng-edit/projects_eav-ui_src_app_permissions_permissions_component_ts.d0e2bb7ed027ab0a.js.map