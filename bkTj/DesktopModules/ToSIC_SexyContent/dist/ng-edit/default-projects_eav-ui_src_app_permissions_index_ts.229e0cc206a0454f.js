"use strict";(self.webpackChunkeav_ui=self.webpackChunkeav_ui||[]).push([["default-projects_eav-ui_src_app_permissions_index_ts","projects_eav-ui_src_app_permissions_permissions_module_ts"],{4328:(E,c,t)=>{t.d(c,{q:()=>p});var r=t(4172),d=t(6028),m=t(4896),h=t(1332),i=t(3392);let p=(()=>{class e{constructor(s,o,_){this.http=s,this.context=o,this.dnnContext=_}create(s,o){return this.http.post(`app/auto/data/${s}`,o,{params:{appId:this.context.appId,zoneId:this.context.zoneId}})}update(s,o,_){return this.http.post(`app/auto/data/${s}/${o}`,_,{params:{appId:this.context.appId,zoneId:this.context.zoneId}})}delete(s,o,_){return this.http.delete(this.dnnContext.$2sxc.http.apiUrl(r.ue+"delete"),{params:{contentType:s,id:o.toString(),appId:this.context.appId.toString(),force:_.toString()}})}static#t=this.\u0275fac=function(o){return new(o||e)(m.CoB(h.KK),m.CoB(d.e),m.CoB(i.es))};static#s=this.\u0275prov=m.wxM({token:e,factory:e.\u0275fac})}return e})()},4720:(E,c,t)=>{t.d(c,{N:()=>d});var r=t(9224);let d=(()=>{class m{static#t=this.route={path:"permissions/:targetType/:keyType/:key",loadChildren:()=>t.e("projects_eav-ui_src_app_permissions_permissions_module_ts").then(t.bind(t,680)).then(i=>i.PermissionsModule),data:{title:"Permissions"}};static getUrl(i,p,e){return`permissions/${i}/${p}/${e}`}static getUrlApp(i){return this.getUrl(r._K.metadata.app.targetType,r._K.metadata.app.keyType,i.toString())}static getUrlAttribute(i){return this.getUrl(r._K.metadata.attribute.targetType,r._K.metadata.attribute.keyType,i.toString())}static getUrlContentType(i){return this.getUrlEntity(i)}static getUrlEntity(i){return this.getUrl(r._K.metadata.entity.targetType,r._K.metadata.entity.keyType,i)}static getUrlLanguage(i){return this.getUrl(r._K.metadata.language.targetType,r._K.metadata.language.keyType,i)}}return m})()},2876:(E,c,t)=>{t.d(c,{NL:()=>r.N,WU:()=>e.W,yM:()=>p.y});var r=t(4720),p=(t(376),t(1628),t(724),t(680),t(7368)),e=t(896)},376:(E,c,t)=>{t.d(c,{r:()=>d});var r=t(5392);const d={name:"SET_PERMISSIONS_DIALOG",initContext:!0,panelSize:"large",panelClass:null,getComponent:()=>(0,r.c)(function*(){const{PermissionsComponent:m}=yield t.e("projects_eav-ui_src_app_permissions_permissions_component_ts").then(t.bind(t,724));return m})()}},1628:(E,c,t)=>{t.d(c,{a:()=>e});var r=t(5204),d=t(404),m=t(6232),h=t(376),i=t(4896);const p=[{path:"",component:m.Y,data:{dialog:h.r},children:[{matcher:d.aM,loadChildren:()=>Promise.all([t.e("default-projects_eav-ui_src_app_create-file-dialog_index_ts"),t.e("default-node_modules_angular_material_fesm2022_list_mjs"),t.e("default-node_modules_angular_material_fesm2022_autocomplete_mjs"),t.e("default-node_modules_angular_material_fesm2022_card_mjs"),t.e("default-projects_eav-ui_src_app_edit_edit_module_ts"),t.e("default-node_modules_angular_cdk_fesm2022_drag-drop_mjs"),t.e("default-node_modules_angular_material_fesm2022_menu_mjs"),t.e("default-node_modules_angular_material_fesm2022_slide-toggle_mjs"),t.e("common"),t.e("projects_eav-ui_src_app_features_feature-names_ts-projects_eav-ui_src_app_features_feature-te-1f7d56")]).then(t.bind(t,3548)).then(u=>u.EditModule)},{matcher:d.CK,loadChildren:()=>t.e("projects_eav-ui_src_app_edit_refresh-edit_module_ts").then(t.bind(t,320)).then(u=>u.RefreshEditModule)}]}];let e=(()=>{class u{static#t=this.\u0275fac=function(_){return new(_||u)};static#s=this.\u0275mod=i.a4G({type:u});static#e=this.\u0275inj=i.s3X({imports:[r.qQ.forChild(p),r.qQ]})}return u})()},724:(E,c,t)=>{t.r(c),t.d(c,{PermissionsComponent:()=>R});var r=t(4844),d=t(5876),m=t(604),h=t(2816),i=t(5760),p=t(1743),e=t(9224),u=t(5396),s=t(4896),o=t(8200),_=t(2328),v=t(6176);let D=(()=>{class g{agInit(a){this.params=a}refresh(a){return!0}deletePermission(){this.params.onDelete(this.params.data)}static#t=this.\u0275fac=function(n){return new(n||g)};static#s=this.\u0275cmp=s.In1({type:g,selectors:[["app-permissions-actions"]],decls:4,vars:0,consts:[[1,"actions-component"],["matRipple","","tippy","Delete",1,"eav-grid-action-button","highlight",3,"click"]],template:function(n,l){1&n&&(s.I0R(0,"div",0)(1,"div",1),s.qCj("click",function(){return l.deletePermission()}),s.I0R(2,"mat-icon"),s.OEk(3,"delete"),s.C$Y()()())},dependencies:[o.Y,_.qL,v.UZ]})}return g})();var y=t(896),O=t(5204),P=t(600),f=t(4648),M=t(4672),T=t(4072),I=t(5056);function K(g,U){if(1&g){const a=s.KQA();s.I0R(0,"div",1)(1,"div",2)(2,"div",3),s.OEk(3,"Permissions"),s.C$Y(),s.I0R(4,"button",4),s.qCj("click",function(){s.usT(a);const l=s.GaO();return s.CGJ(l.closeDialog())}),s.I0R(5,"mat-icon"),s.OEk(6,"close"),s.C$Y()()(),s.I0R(7,"div",5),s.wR5(8,"router-outlet"),s.I0R(9,"div",6),s.wR5(10,"ag-grid-angular",7),s.C$Y(),s.I0R(11,"mat-dialog-actions",8)(12,"button",9),s.qCj("click",function(){s.usT(a);const l=s.GaO();return s.CGJ(l.editPermission(null))}),s.I0R(13,"mat-icon"),s.OEk(14,"add"),s.C$Y()()()()()}if(2&g){const a=s.GaO();s.yG2(10),s.E7m("rowData",U.permissions)("gridOptions",a.gridOptions)}}let R=(()=>{class g extends h.K{constructor(a,n,l,C,B){super(a,n),this.router=a,this.route=n,this.dialogRef=l,this.permissionsService=C,this.snackBar=B,this.permissions$=new r.g(void 0),this.gridOptions=this.buildGridOptions(),this.targetType=parseInt(this.route.snapshot.paramMap.get("targetType"),10),this.keyType=this.route.snapshot.paramMap.get("keyType"),this.key=this.route.snapshot.paramMap.get("key"),this.prefills={[e._K.metadata.language.targetType]:{PermissionType:"language"}}}ngOnInit(){this.fetchPermissions(),this.subscription.add(this.refreshOnChildClosedShallow().subscribe(()=>{this.fetchPermissions()})),this.viewModel$=(0,d.E)([this.permissions$]).pipe((0,m.k)(([a])=>({permissions:a})))}ngOnDestroy(){this.permissions$.complete(),super.ngOnDestroy()}closeDialog(){this.dialogRef.close()}fetchPermissions(){this.permissionsService.getAll(this.targetType,this.keyType,this.key).subscribe(a=>{this.permissions$.next(a)})}editPermission(a){let n;n=null==a?{items:[{ContentTypeName:e._K.contentTypes.permissions,For:{Target:Object.values(e._K.metadata).find(C=>C.targetType===this.targetType)?.target??this.targetType.toString(),TargetType:this.targetType,...this.keyType===e._K.keyTypes.guid&&{Guid:this.key},...this.keyType===e._K.keyTypes.number&&{Number:parseInt(this.key,10)},...this.keyType===e._K.keyTypes.string&&{String:this.key}},...this.prefills[this.targetType]&&{Prefill:this.prefills[this.targetType]}}]}:{items:[{EntityId:a.Id}]};const l=(0,u.K)(n);this.router.navigate([`edit/${l}`],{relativeTo:this.route})}deletePermission(a){confirm(`Delete '${a.Title}' (${a.Id})?`)&&(this.snackBar.open("Deleting..."),this.permissionsService.delete(a.Id).subscribe(()=>{this.snackBar.open("Deleted",null,{duration:2e3}),this.fetchPermissions()}))}buildGridOptions(){return{...p.A,columnDefs:[{headerName:"ID",field:"Id",width:70,headerClass:"dense",cellClass:"id-action no-padding no-outline".split(" "),sortable:!0,filter:"agNumberColumnFilter",valueGetter:n=>n.data.Id,cellRenderer:i.q,cellRendererParams:{tooltipGetter:l=>`ID: ${l.Id}\nGUID: ${l.Guid}`}},{field:"Name",flex:2,minWidth:250,cellClass:"primary-action highlight".split(" "),sortable:!0,sort:"asc",filter:"agTextColumnFilter",onCellClicked:n=>{this.editPermission(n.data)},valueGetter:n=>n.data.Title},{field:"Identity",flex:2,minWidth:250,cellClass:"no-outline",sortable:!0,filter:"agTextColumnFilter",valueGetter:n=>n.data.Identity},{field:"Condition",flex:2,minWidth:250,cellClass:"no-outline",sortable:!0,filter:"agTextColumnFilter",valueGetter:n=>n.data.Condition},{field:"Grant",width:70,headerClass:"dense",cellClass:"no-outline",sortable:!0,filter:"agTextColumnFilter",valueGetter:n=>n.data.Grant},{width:42,cellClass:"secondary-action no-padding".split(" "),pinned:"right",cellRenderer:D,cellRendererParams:{onDelete:l=>this.deletePermission(l)}}]}}static#t=this.\u0275fac=function(n){return new(n||g)(s.GI1(O.E5),s.GI1(O.gV),s.GI1(P.yI),s.GI1(y.W),s.GI1(f.yS))};static#s=this.\u0275cmp=s.In1({type:g,selectors:[["app-permissions"]],features:[s.eg9],decls:2,vars:3,consts:[["class","eav-dialog nav-component-wrapper"],[1,"eav-dialog","nav-component-wrapper"],[1,"eav-dialog-header"],[1,"eav-dialog-header__title"],["mat-icon-button","","tippy","Close dialog",3,"click"],[1,"eav-dialog-content","nav-component-wrapper"],[1,"grid-wrapper"],[1,"ag-theme-material",3,"rowData","gridOptions"],["align","end"],["mat-fab","","mat-elevation-z24","","tippy","Create a new permission",1,"grid-fab",3,"click"]],template:function(n,l){if(1&n&&(s.yuY(0,K,15,2,"div",0),s.wVc(1,"async")),2&n){let C;s.C0Y(0,(C=s.kDX(1,1,l.viewModel$))?0:-1,C)}},dependencies:[O.cP,o.Y,P.Yp,M.um,M.uw,_.qL,T.U5,I.a]})}return g})()},680:(E,c,t)=>{t.r(c),t.d(c,{PermissionsModule:()=>O});var r=t(5056),d=t(4672),m=t(6176),h=t(600),i=t(2328),p=t(4648),e=t(4328),u=t(4580),s=t(6028),o=t(988),_=t(1628),v=t(7368),D=t(896),y=t(4896);let O=(()=>{class P{static#t=this.\u0275fac=function(T){return new(T||P)};static#s=this.\u0275mod=y.a4G({type:P});static#e=this.\u0275inj=y.s3X({providers:[s.e,D.W,v.y,e.q],imports:[r.MD,_.a,o.q,h.sr,d.oJ,i.oB,u.c,m.KE,p.uE]})}return P})()},7368:(E,c,t)=>{t.d(c,{y:()=>p});var r=t(6028),d=t(4896),m=t(1332),h=t(3392);let p=(()=>{class e{constructor(s,o,_){this.http=s,this.context=o,this.dnnContext=_}getMetadata(s,o,_,v){return this.http.get(this.dnnContext.$2sxc.http.apiUrl("admin/metadata/get"),{params:{appId:this.context.appId.toString(),targetType:s.toString(),keyType:o,key:_.toString(),...v&&{contentType:v}}})}static#t=this.\u0275fac=function(o){return new(o||e)(d.CoB(m.KK),d.CoB(r.e),d.CoB(h.es))};static#s=this.\u0275prov=d.wxM({token:e,factory:e.\u0275fac})}return e})()},896:(E,c,t)=>{t.d(c,{W:()=>p});var r=t(604),d=t(4328),m=t(9224),h=t(7368),i=t(4896);let p=(()=>{class e{constructor(s,o){this.metadataService=s,this.entitiesService=o}getAll(s,o,_){return this.metadataService.getMetadata(s,o,_,m._K.contentTypes.permissions).pipe((0,r.k)(v=>v.Items))}delete(s){return this.entitiesService.delete(m._K.contentTypes.permissions,s,!1)}static#t=this.\u0275fac=function(o){return new(o||e)(i.CoB(h.y),i.CoB(d.q))};static#s=this.\u0275prov=i.wxM({token:e,factory:e.\u0275fac})}return e})()}}]);
//# sourceMappingURL=https://sources.2sxc.org/17.04.00/dist/ng-edit/default-projects_eav-ui_src_app_permissions_index_ts.229e0cc206a0454f.js.map