"use strict";(self.webpackChunkeav_ui=self.webpackChunkeav_ui||[]).push([["projects_eav-ui_src_app_app-administration_sub-dialogs_views-usage_views-usage_component_ts"],{9248:(N,c,o)=>{o.r(c),o.d(c,{ViewsUsageComponent:()=>B});var r=o(4844),v=o(5876),C=o(604),I=o(1743),w=o(7184);function b(n){const a=n.data;return`ID: ${a.Block.Id}\nGUID: ${a.Block.Guid}`}function y(n){const a=n.data;if(null!=a.Module)return`ID: ${a.Module.Id}\nUsageId: ${a.Module.UsageId}\nTitle: ${a.Module.Title}`}function G(n){return((null!=n.value?"id-action no-padding":"")+" no-outline").split(" ")}function $(n){const a=n.data;if(null!=a.PageId)return`ID: ${a.PageId}`}function V(n){return((null!=n.value?"id-action no-padding":"")+" no-outline").split(" ")}function O(n){return(null!=n.value?"primary-action highlight":"no-outline").split(" ")}function M(n){null!=n.value&&window.open(n.data.Url,"_blank")}function x(n){const a=n.value;if(null!=a)return`\n    <div style="height: 100%;display: flex;align-items: center;">\n      ${a.IsVisible?'<span class="material-icons-outlined">visibility</span>':'<span class="material-icons-outlined">visibility_off</span>'}\n      ${a.IsDeleted?'<span style="margin-left: 8px;" class="material-icons-outlined">delete</span>':""}\n    </div>\n  `}var D=o(2556),e=o(4896),P=o(4648),g=o(8200),p=o(2328),R=o(6176);function U(n,a){if(1&n){const t=e.KQA();e.I0R(0,"div",1),e.qCj("click",function(){e.usT(t);const s=e.GaO();return e.CGJ(s.copy())}),e.I0R(1,"span",2),e.OEk(2),e.C$Y(),e.I0R(3,"mat-icon",3),e.OEk(4,"file_copy"),e.C$Y()()}if(2&n){const t=e.GaO();e.E7m("tippy",t.tooltip),e.yG2(2),e.cNF(t.id)}}let u=(()=>{class n{constructor(t){this.snackBar=t}agInit(t){if(this.tooltip=t.value,null==this.tooltip)return;const i=this.tooltip.split("\n")[0];this.id=i.split(" ")[1]}refresh(t){return!0}copy(){(0,D.y)(this.tooltip),this.snackBar.open("Copied to clipboard",null,{duration:2e3})}static#e=this.\u0275fac=function(i){return new(i||n)(e.GI1(P.yS))};static#t=this.\u0275cmp=e.In1({type:n,selectors:[["app-views-usage-id"]],decls:1,vars:1,consts:[["matRipple","","class","id-box highlight",3,"tippy"],["matRipple","",1,"id-box","highlight",3,"tippy","click"],[1,"id"],[1,"icon"]],template:function(i,s){1&i&&e.yuY(0,U,5,2,"div",0),2&i&&e.C0Y(0,s.id?0:-1)},dependencies:[g.Y,p.qL,R.UZ],styles:[".id-box[_ngcontent-%COMP%]{padding:0 8px;text-align:end;height:100%;display:flex;align-items:center;justify-content:flex-end}.id-box[_ngcontent-%COMP%]   .id[_ngcontent-%COMP%]{max-width:100%;text-overflow:ellipsis;overflow:hidden}.id-box[_ngcontent-%COMP%]:hover{text-decoration:none}.id-box[_ngcontent-%COMP%]:hover   .id[_ngcontent-%COMP%]{display:none}.id-box[_ngcontent-%COMP%]:not(:hover)   .icon[_ngcontent-%COMP%]{display:none}"]})}return n})();var h=o(1904),m=o(1232);let T=(()=>{class n{constructor(){this.isVisible="",this.isDeleted=""}agInit(t){this.filterParams=t}isFilterActive(){return""!==this.isVisible||""!==this.isDeleted}doesFilterPass(t){let i=!1,s=!1;const d=this.filterParams.valueGetter({api:this.filterParams.api,colDef:this.filterParams.colDef,column:this.filterParams.column,columnApi:this.filterParams.columnApi,context:this.filterParams.context,data:t.node.data,getValue:j=>t.node.data[j],node:t.node});return null!=d&&(i=""===this.isVisible||null!=d.IsVisible&&d.IsVisible.toString()===this.isVisible,s=""===this.isDeleted||null!=d.IsDeleted&&d.IsDeleted.toString()===this.isDeleted,i&&s)}getModel(){if(this.isFilterActive())return{filterType:"views-usage-status",isVisible:this.isVisible,isDeleted:this.isDeleted}}setModel(t){this.isVisible=t?t.isVisible:"",this.isDeleted=t?t.isDeleted:""}afterGuiAttached(t){}filterChanged(){this.filterParams.filterChangedCallback()}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275cmp=e.In1({type:n,selectors:[["app-views-usage-status-filter"]],decls:18,vars:2,consts:[[1,"title"],[3,"ngModel","ngModelChange"],["value",""],["value","true"],["value","false"]],template:function(i,s){1&i&&(e.I0R(0,"div",0),e.OEk(1,"Visible"),e.C$Y(),e.I0R(2,"mat-radio-group",1),e.qCj("ngModelChange",function(d){return s.isVisible=d})("ngModelChange",function(){return s.filterChanged()}),e.I0R(3,"mat-radio-button",2),e.OEk(4,"All"),e.C$Y(),e.I0R(5,"mat-radio-button",3),e.OEk(6,"Visible"),e.C$Y(),e.I0R(7,"mat-radio-button",4),e.OEk(8,"Hidden"),e.C$Y()(),e.I0R(9,"div",0),e.OEk(10,"Deleted"),e.C$Y(),e.I0R(11,"mat-radio-group",1),e.qCj("ngModelChange",function(d){return s.isDeleted=d})("ngModelChange",function(){return s.filterChanged()}),e.I0R(12,"mat-radio-button",2),e.OEk(13,"All"),e.C$Y(),e.I0R(14,"mat-radio-button",3),e.OEk(15,"Is deleted"),e.C$Y(),e.I0R(16,"mat-radio-button",4),e.OEk(17,"Is not deleted"),e.C$Y()()),2&i&&(e.yG2(2),e.E7m("ngModel",s.isVisible),e.yG2(9),e.E7m("ngModel",s.isDeleted))},dependencies:[h.ue,h._G,m.cv,m.cT],styles:[".title[_ngcontent-%COMP%]{padding:12px 12px 0}.mat-mdc-radio-group[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:space-between;overflow:hidden;padding:12px;width:160px;height:104px}"]})}return n})();var E=o(600),f=o(5204),Y=o(4672),F=o(4072),S=o(5056);function A(n,a){if(1&n){const t=e.KQA();e.I0R(0,"div",1)(1,"div",2)(2,"div",3)(3,"div",4),e.OEk(4),e.C$Y(),e.I0R(5,"button",5),e.qCj("click",function(){e.usT(t);const s=e.GaO();return e.CGJ(s.closeDialog())}),e.I0R(6,"mat-icon"),e.OEk(7,"close"),e.C$Y()()()(),e.I0R(8,"p",6),e.OEk(9," This shows where this view is being used. Read about the "),e.I0R(10,"a",7),e.OEk(11,"connections between DNN and 2sxc Views"),e.C$Y(),e.OEk(12," to make good decisions if you're doing clean-up or just want to better know what this is all about. "),e.I0R(13,"em"),e.OEk(14,"Before you get confused about some things you see here, do read the FAQ on that page."),e.C$Y()(),e.wR5(15,"router-outlet"),e.I0R(16,"div",8),e.wR5(17,"ag-grid-angular",9)(18,"div",10),e.C$Y()()}if(2&n){const t=e.GaO();e.yG2(3),e.E7m("tippy",a.viewTooltip),e.yG2(1),e.oRS("View: ",null==a.viewUsage?null:a.viewUsage.Name,""),e.yG2(13),e.E7m("rowData",a.data)("gridOptions",t.gridOptions)}}let B=(()=>{class n{constructor(t,i,s){this.dialogRef=t,this.route=i,this.viewsService=s,this.viewUsage$=new r.g(void 0),this.viewTooltip$=new r.g(void 0),this.data$=new r.g(void 0),this.gridOptions=this.buildGridOptions()}ngOnInit(){const t=this.route.snapshot.paramMap.get("guid");this.viewsService.getUsage(t).subscribe(i=>{const s=i[0];this.viewUsage$.next(s),this.viewTooltip$.next(`ID: ${s.Id}\nGUID: ${s.Guid}`);const d=function k(n){const a=[];for(const t of n.Blocks){0===t.Modules.length&&a.push({Block:{Id:t.Id,Guid:t.Guid}});for(const i of t.Modules)a.push({Block:{Id:t.Id,Guid:t.Guid},Module:i,PageId:i.Page.Id,Name:i.Page.Name,Url:i.Page.Url,Language:i.Page.CultureCode,Status:{IsVisible:i.Page.Visible,IsDeleted:i.IsDeleted}})}return a}(s);this.data$.next(d)}),this.viewModel$=(0,v.E)([this.viewUsage$,this.viewTooltip$,this.data$]).pipe((0,C.k)(([i,s,l])=>({viewUsage:i,viewTooltip:s,data:l})))}ngOnDestroy(){this.viewUsage$.complete(),this.viewTooltip$.complete(),this.data$.complete()}closeDialog(){this.dialogRef.close()}buildGridOptions(){return{...I.A,columnDefs:[{field:"Block",width:70,headerClass:"dense",cellClass:"id-action no-padding no-outline".split(" "),sortable:!0,filter:"agTextColumnFilter",valueGetter:b,cellRenderer:u},{field:"Module",width:76,headerClass:"dense",sortable:!0,filter:"agTextColumnFilter",valueGetter:y,cellClass:G,cellRenderer:u},{field:"Page",width:70,headerClass:"dense",sortable:!0,filter:"agTextColumnFilter",valueGetter:$,cellClass:V,cellRenderer:u},{field:"Name",flex:2,minWidth:250,sortable:!0,sort:"asc",filter:"agTextColumnFilter",valueGetter:i=>i.data.Name,cellClass:O,onCellClicked:M},{field:"Language",width:90,cellClass:"no-outline",sortable:!0,filter:"agTextColumnFilter",valueGetter:i=>i.data.Language},{field:"Status",width:80,cellClass:"icon no-outline".split(" "),filter:T,cellRenderer:x,valueGetter:i=>i.data.Status}]}}static#e=this.\u0275fac=function(i){return new(i||n)(e.GI1(E.yI),e.GI1(f.gV),e.GI1(w.s))};static#t=this.\u0275cmp=e.In1({type:n,selectors:[["app-views-usage"]],decls:2,vars:3,consts:[["class","nav-component-wrapper"],[1,"nav-component-wrapper"],["mat-mdc-dialog-title",""],[1,"dialog-title-box"],[3,"tippy"],["mat-icon-button","","tippy","Close dialog",3,"click"],[1,"dialog-description"],["href","https://go.2sxc.org/content-in-dnn","target","_blank"],[1,"grid-wrapper"],[1,"ag-theme-material",3,"rowData","gridOptions"],[1,"grid-more-actions-box"]],template:function(i,s){if(1&i&&(e.yuY(0,A,19,4,"div",0),e.wVc(1,"async")),2&i){let l;e.C0Y(0,(l=e.kDX(1,1,s.viewModel$))?0:-1,l)}},dependencies:[f.cP,g.Y,Y.um,p.qL,F.U5,S.a]})}return n})()}}]);
//# sourceMappingURL=https://sources.2sxc.org/17.04.00/dist/ng-edit/projects_eav-ui_src_app_app-administration_sub-dialogs_views-usage_views-usage_component_ts.ecfa5833eea39f6e.js.map