"use strict";(self.webpackChunkeav_ui=self.webpackChunkeav_ui||[]).push([["projects_eav-ui_src_app_apps-management_create-app_create-app_component_ts"],{3496:(b,p,a)=>{a.r(p),a.d(p,{CreateAppComponent:()=>k});var r=a(1904),d=a(4844),u=a(604);const C=/^[A-Za-z](?:[A-Za-z0-9\s\(\)-]+)*$/;var h=a(924),t=a(4896),m=a(600),v=a(4648),g=a(5204),I=a(9084),y=a(4672),E=a(2536),c=a(244),A=a(7872),G=a(6176),R=a(5056);function T(o,l){1&o&&(t.I0R(0,"app-field-hint",15),t.OEk(1," Required "),t.C$Y()),2&o&&t.E7m("isError",!0)}function Y(o,l){if(1&o&&(t.I0R(0,"app-field-hint",15),t.OEk(1),t.C$Y()),2&o){const e=t.GaO(3);t.E7m("isError",!0),t.yG2(1),t.oRS(" ",e.appNameError," ")}}function $(o,l){if(1&o&&t.yuY(0,T,2,1,"app-field-hint",15)(1,Y,2,2,"app-field-hint",15),2&o){const e=t.GaO(2);t.C0Y(0,null!=e.form.controls.name.errors&&e.form.controls.name.errors.required?0:-1),t.yG2(1),t.C0Y(1,null!=e.form.controls.name.errors&&e.form.controls.name.errors.pattern?1:-1)}}function O(o,l){if(1&o){const e=t.KQA();t.I0R(0,"div",1)(1,"div",2)(2,"div",3),t.OEk(3,"Create App"),t.C$Y()(),t.I0R(4,"div",4),t.wR5(5,"router-outlet"),t.I0R(6,"form",5)(7,"mat-form-field",6)(8,"mat-label"),t.OEk(9,"Name"),t.C$Y(),t.wR5(10,"input",7),t.C$Y(),t.I0R(11,"app-field-hint"),t.OEk(12," App name will also be used for the folder "),t.C$Y(),t.yuY(13,$,2,2),t.wR5(14,"br"),t.I0R(15,"mat-form-field",6)(16,"mat-label"),t.OEk(17,"Template"),t.C$Y(),t.I0R(18,"mat-select",8),t.qCj("valueChange",function(i){t.usT(e);const s=t.GaO();return t.CGJ(s.appTemplateId=i)}),t.I0R(19,"mat-option",9),t.OEk(20," Completely Naked / Raw App "),t.C$Y(),t.I0R(21,"mat-option",10),t.OEk(22," App Template Empty with some instructions "),t.C$Y(),t.I0R(23,"mat-option",11),t.OEk(24," App Template Basic with instructions and some data "),t.C$Y()()()()(),t.I0R(25,"mat-dialog-actions",12)(26,"button",13),t.qCj("click",function(){t.usT(e);const i=t.GaO();return t.CGJ(i.closeDialog())}),t.OEk(27," Cancel "),t.C$Y(),t.I0R(28,"button",14),t.qCj("click",function(){t.usT(e);const i=t.GaO();return t.CGJ(i.create())}),t.OEk(29," Create "),t.C$Y()()()}if(2&o){const e=t.GaO();t.yG2(6),t.E7m("formGroup",e.form),t.yG2(7),t.C0Y(13,e.form.controls.name.touched?13:-1),t.yG2(5),t.E7m("value",e.appTemplateId),t.yG2(8),t.E7m("disabled",l.loading),t.yG2(2),t.E7m("disabled",l.loading||!e.form.valid)}}let k=(()=>{class o{constructor(e,n,i){this.dialogRef=e,this.appsListService=n,this.snackBar=i,this.hostClass="dialog-component",this.appNameError="Standard letters, numbers, spaces, hyphens and round brackets are allowed. Must start with a letter.",this.appTemplateId="1",this.form=this.buildForm(),this.loading$=new d.g(!1)}ngOnInit(){this.viewModel$=this.loading$.pipe((0,u.k)(e=>({loading:e})))}ngOnDestroy(){this.loading$.complete()}closeDialog(){this.dialogRef.close()}create(){this.form.disable(),this.loading$.next(!0);const e=this.form.controls.name.value?.trim().replace(/\s\s+/g," "),n=Number(this.appTemplateId);this.snackBar.open("Creating app..."),this.appsListService.create(e,null,n).subscribe({error:()=>{this.form.enable(),this.loading$.next(!1),this.snackBar.open("Failed to create app. Please check console for more information",void 0,{duration:3e3})},next:()=>{this.form.enable(),this.snackBar.open("Created app",void 0,{duration:2e3}),this.closeDialog()}})}buildForm(){return new r.k1({name:new r.yM(null,[r.AQ.required,r.AQ.pattern(C)])})}static#t=this.\u0275fac=function(n){return new(n||o)(t.GI1(m.yI),t.GI1(h.m),t.GI1(v.yS))};static#e=this.\u0275cmp=t.In1({type:o,selectors:[["app-create-app"]],hostVars:1,hostBindings:function(n,i){2&n&&t.SoX("className",i.hostClass)},decls:2,vars:3,consts:[["class","eav-dialog"],[1,"eav-dialog"],[1,"eav-dialog-header"],[1,"eav-dialog-header__title"],[1,"eav-dialog-content"],[3,"formGroup"],["color","accent",1,"eav-form-field"],["matInput","","type","text","formControlName","name"],["required","true",3,"value","valueChange"],["value","0"],["value","1"],["value","2"],["align","end"],["type","button","mat-raised-button","",3,"disabled","click"],["type","button","mat-raised-button","","color","accent",3,"disabled","click"],[3,"isError"]],template:function(n,i){if(1&n&&(t.yuY(0,O,30,5,"div",0),t.wVc(1,"async")),2&n){let s;t.C0Y(0,(s=t.kDX(1,1,i.viewModel$))?0:-1,s)}},dependencies:[g.cP,I.o,m.Yp,y.Gw,r.sz,r.ot,r.ue,r.u,E.yi,c.Up,c.w5,r.uW,r.Wo,A.kX,G.I5,R.a]})}return o})()}}]);
//# sourceMappingURL=https://sources.2sxc.org/17.04.00/dist/ng-edit/projects_eav-ui_src_app_apps-management_create-app_create-app_component_ts.0be8562284275123.js.map